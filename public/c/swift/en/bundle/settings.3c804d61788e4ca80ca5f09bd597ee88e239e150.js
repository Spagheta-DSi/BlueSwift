define("app/ui/alert_banner",["module","require","exports","core/component"],function(module, require, exports) {
function alertBanner(){this.defaultAttrs({closeSelector:"#settings-alert-close",bannerSelector:"h4,p",listenToShow:!0}),this.showBanner=function(a,b){$(window).scrollTop(0),this.select("bannerSelector").remove(),this.$node.append($("<h4>").text(b.message)),this.$node.show()},this.closeBanner=function(){this.select("bannerSelector").remove(),this.$node.hide()},this.after("initialize",function(){this.attr.listenToShow&&this.on(document,"uiAlertBanner",this.showBanner),this.on(document,"uiAlertBannerClose",this.closeBanner),this.on(this.attr.closeSelector,"click",this.closeBanner)})}var defineComponent=require("core/component"),AlertBanner=defineComponent(alertBanner);module.exports=AlertBanner
});
define("app/ui/forms/with_submit_disable",["module","require","exports"],function(module, require, exports) {
function withSubmitDisable(){this.defaultAttrs({submit:":input[type=submit]"}),this.enable=function(){this.isDisabled&&this.$submit.attr("disabled",!1),this.isDisabled=!1},this.disable=function(){this.isDisabled||this.$submit.attr("disabled",!0),this.isDisabled=!0},this.setInitialState=function(){this.$submit=this.select("submit"),this.isDisabled=!1,this.disable()},this.after("initialize",function(){this.on(document,"uiSwiftLoaded uiPageChanged",this.setInitialState),this.on("dataFormValueModified",this.enable),this.on("dataFormValueInit dataFormValueReset",this.disable)})}module.exports=withSubmitDisable
});
define("app/ui/forms/form_value_modification",["module","require","exports","core/component","app/ui/forms/with_submit_disable"],function(module, require, exports) {
function formValueModification(){function a(a,b){var c=Object.keys(a),d=Object.keys(b);return c.concat($.makeArray($(d).not(c)))}function b(b,c){var d=a(b,c);return d.every(function(a){return h(b[a],c[a])})}function c(a){return!!a.name}function d(a){return[a.name,f(a)]}function e(a,b){var c=b[0],d=b[1];return g(d)?a:(a[c]!==undefined?Array.isArray(a[c])?a[c].push(d):a[c]=[a[c],d]:a[c]=d,a)}function f(a){var b=$(a);return b.is("[type=checkbox],[type=radio]")?b.is(":checked")?b.val():undefined:b.val()}function g(a){return a===undefined||String(a).length===0}function h(a,b){return Array.isArray(a)&&Array.isArray(b)?$(a).not(b).length===0&&$(b).not(a).length===0:g(a)&&g(b)?!0:a===b}this.defaultAttrs({fields:":input"}),this.after("initialize",function(){this.initialValues=this.currentValues(),this.isModified=!1,this.trigger("dataFormValueInit"),this.on("change keyup",{fields:this.onChange})}),this.dataModified=function(){this.trigger("dataFormValueModified"),this.isModified=!0},this.dataUnchanged=function(){this.isModified&&this.trigger("dataFormValueReset"),this.isModified=!1},this.currentValues=function(){return $.makeArray(this.select("fields")).filter(c).map(d).reduce(e,{})},this.onChange=function(a){if($(a.target).is("[type=file]")){this.dataModified(),this.off("change keyup");return}b(this.currentValues(),this.initialValues)?this.dataUnchanged():this.dataModified()}}var defineComponent=require("core/component"),withSubmitDisable=require("app/ui/forms/with_submit_disable"),FormValueModification=defineComponent(formValueModification,withSubmitDisable);module.exports=FormValueModification
});
define("app/boot/settings",["module","require","exports","app/boot/app","app/data/settings","app/ui/alert_banner","app/utils/image","app/ui/forms/form_value_modification","app/data/email_follow_data"],function(module, require, exports) {
var bootApp=require("app/boot/app"),SettingsData=require("app/data/settings"),AlertBanner=require("app/ui/alert_banner"),image=require("app/utils/image"),FormDataModification=require("app/ui/forms/form_value_modification"),EmailFollowData=require("app/data/email_follow_data");module.exports=function(b){bootApp(b),SettingsData.attachTo(document,b),AlertBanner.attachTo("#settings-alert-box"),image.supportsCropper()?AlertBanner.attachTo("#inline-edit-nudge",{closeSelector:".close",listenToShow:!1}):$("#inline-edit-nudge").hide(),EmailFollowData.attachTo("#timeline"),FormDataModification.attachTo("#account-form, #password-form, #sms-phone-create-form, #sms-phone-verified-form, #notifications-form, #profile-form")}
});
define("app/data/settings/account_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function accountScribe(){this.after("initialize",function(){function a(a){return{item_names:[a.value]}}this.scribeOnEvent("uiDialogOpened","open"),this.on("uiDialogClosed",function(a,b){b&&b.scribeContext&&b.scribeContext.component&&this.scribe("close",b)}),this.scribeOnEvent("uiCancelPendingEmail","click"),this.scribeOnEvent("uiResendPendingEmail","click"),this.scribeOnEvent("uiClickEmailCorrection",{component:"form",element:"email_autocorrect",action:"click"}),this.scribeOnEvent("uiShowEmailCorrection",{component:"form",element:"email_autocorrect",action:"impression"}),this.on("dataUsernameResult dataEmailResult",function(b,c){this.scribe(c.valid?"success":"failure",c,a)}),this.scribeOnEvent("dataUsernameError dataEmailError","error",a)})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),AccountScribe=defineComponent(accountScribe,withScribe);module.exports=AccountScribe
});
define("app/data/form_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function formScribe(){this.scribeFormElement=function(b,c,d){var e={action:c};b&&(e.element=b),this.attr.eventData&&(e=$.extend({},this.attr.eventData.scribeContext,e)),this.scribe(e,d)},this.registerSelect=function(b,c){this.on(b,"change",function(){var a=b.val();typeof a.sort!="function"&&(a=[a]),this.scribeFormElement(c,"change",{item_names:a})})},this.registerButton=function(b,c){this.on(b,"click",function(a){this.scribeFormElement(c,"click")})},this.registerLink=function(b,c){this.on(b,"click",function(a){this.scribeFormElement(c,"click",{url:b.attr("href")})})},this.registerTextField=function(b,c){this.on(b,"change",function(a){this.scribeFormElement(c,"change",{item_names:[b.val().substring(0,255)]})})},this.registerPasswordField=function(b,c){this.on(b,"change",function(a){this.scribeFormElement(c,"change")})},this.registerCheckbox=function(b,c){this.on(b,"change",function(a){this.scribeFormElement(c,a.target.checked?"select":"deselect")})},this.registerRadio=function(b,c){this.on(b,"change",function(a){a.target.checked&&this.scribeFormElement(c,"select",{item_names:[b.val()]})})},this.registerFormListeners=function(){if(this.attr.scribeFormSubmit){var c=this.$node.find("form");c.length||(c=this.$node),this.on(c,"submit",function(a,b){this.scribeFormElement(null,"submit",b)})}Object.keys(this.attr.formElements).forEach(function(b){var c=this.$node.find(this.attr.formElements[b]),d=c.prop("tagName"),e=c.attr("type"),f=a[d];f&&f.bind(this)(c,b)},this)},this.registerInput=function(c,d){var e=b[c.attr("type")];e&&e.bind(this)(c,d)};var a={SELECT:this.registerSelect,BUTTON:this.registerButton,TEXTAREA:this.registerTextField,A:this.registerLink,INPUT:this.registerInput},b={password:this.registerPasswordField,text:this.registerTextField,file:this.registerTextField,checkbox:this.registerCheckbox,radio:this.registerRadio,button:this.registerButton,submit:this.registerButton,cancel:this.registerButton};this.after("initialize",function(){this.registerFormListeners()})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),FormScribe=defineComponent(formScribe,withScribe);module.exports=FormScribe
});
define("app/ui/with_forgot_password",["module","require","exports"],function(module, require, exports) {
function withForgotPassword(){this.notifyForgotPassword=function(a){return a.preventDefault(),this.trigger("uiForgotPassword",{url:this.select("forgotSelector").attr("href"),scribeContext:{element:"resend_password"}}),!1},this.notifyReminderSent=function(){var a=this.select("reminderSelector");a.css({visibility:"visible",opacity:"1"}),a.delay(5e3).animate({opacity:"0"},"fast")},this.after("initialize",function(){var a=this.select("forgotSelector");this.on(a,"click",this.notifyForgotPassword),this.on(document,"dataForgotPasswordSuccess",this.notifyReminderSent)})}module.exports=withForgotPassword
});
define("app/ui/password_dialog",["module","require","exports","core/component","app/ui/with_dialog","app/ui/with_position","app/ui/with_forgot_password"],function(module, require, exports) {
function passwordDialog(){this.defaultAttrs({forgotSelector:"#forgot_password",reminderSelector:"#reminder_sent",passwordSelector:"#auth_password",cancelSelector:"#cancel_password_button",saveChangesSelector:"#save_password"}),this.focusPassword=function(){this.select("passwordSelector").focus().val("")},this.blurPassword=function(){this.select("passwordSelector").blur()},this.after("initialize",function(){this.on("click",{cancelSelector:this.close,forgotSelector:this.notifyForgotPassword}),this.on(document,"uiOpenPasswordDialog",this.open),this.on(document,"dataForgotPasswordSuccess",this.notifyReminderSent),this.on("uiDialogOpened",this.focusPassword),this.on("uiDialogClosed",this.blurPassword)})}var defineComponent=require("core/component"),withDialog=require("app/ui/with_dialog"),withPosition=require("app/ui/with_position"),withForgotPassword=require("app/ui/with_forgot_password"),PasswordDialog=defineComponent(passwordDialog,withDialog,withPosition,withForgotPassword);module.exports=PasswordDialog
});
define("app/ui/email_field_highlight",["module","require","exports","core/component","app/utils/params"],function(module, require, exports) {
function emailFieldHighlight(){this.defaultAttrs({emailFieldsetSelector:"#email_fieldset"}),this.highlightField=function(){$(this.attr.emailFieldsetSelector).addClass("alert")},this.after("initialize",function(){params.fromQuery(window.location).email_highlight&&this.highlightField()})}var defineComponent=require("core/component"),params=require("app/utils/params"),EmailFieldHighlight=defineComponent(emailFieldHighlight);module.exports=EmailFieldHighlight
});
define("app/ui/validating_fieldset",["module","require","exports","core/component","core/utils","core/i18n"],function(module, require, exports) {
function validatingInputFieldSet(){var a="ok",b="problem";this.defaultAttrs({emailCorrectionSelector:".js-email-correction",debounceTime:750}),this.updateWithValidation=function(a,b){this.displayFeedback(b.valid,!b.valid,b.msg,b.email_suggestion)},this.displayError=function(a,b){this.displayFeedback(!1,!0,_('An error occured'))},this.showMessages=function(d,e){this.$node.toggleClass(a,!!d),this.$node.toggleClass(b,!!e)},this.handleInput=function(b){var c=b.target.value;if(this._old==c)return;this.select("echoLabel").text(c),this.displayFeedback(!1,!1,_('Checking...'));var d={};d[this.attr.name.toLowerCase()]=c,d.value=c,this.trigger(this.attr.changeEvent,d),this._old=c},this.suggestEmail=function(a){var b="<a class = 'js-email-correction' href='#'>"+a+"</a>";this.select("notification").html(_('Did you mean {{link}}?',{link:b})),$(document).trigger("uiShowEmailCorrection"),this.select("emailCorrectionSelector").click(function(b){$(document).trigger("uiClickEmailCorrection"),this.select("input").val(a).trigger("updateNow")}.bind(this))},this.displayFeedback=function(b,c,d,e){function f(){this.showMessages(b,c),e?this.suggestEmail(e):$(this.attr.notification).text(d),$(this.attr.notification).show()}if(!d){this.showMessages(b,c);return}$(this.attr.notification).hide(0,f.bind(this))},this.after("initialize",function(){this._old=$(this.attr.input).val(),this.on(document,"data"+this.attr.name+"Result",this.updateWithValidation),this.on(document,"data"+this.attr.name+"Error",this.displayError),this.on("keyup",utils.debounce(this.handleInput,this.attr.debounceTime)),this.on("updateNow",this.handleInput)})}var defineComponent=require("core/component"),utils=require("core/utils"),_=require("core/i18n"),ValidatingInputFieldSet=defineComponent(validatingInputFieldSet);module.exports=ValidatingInputFieldSet
});
define("app/ui/email_confirmation",["module","require","exports","core/component","core/i18n"],function(module, require, exports) {
function emailConfirmationListener(){this.defaultAttrs({cancelSelector:"a.cancel-pending-email",resendSelector:"a.resend-confirmation-email"}),this.cancelEmail=function(){return this.trigger("uiCancelPendingEmail",{url:this.select("cancelSelector").attr("href"),scribeContext:{element:"cancel_pending_email"}}),!1},this.resendEmail=function(){return this.trigger("uiResendPendingEmail",{url:this.select("resendSelector").attr("href"),scribeContext:{element:"resend_confirmation_email"}}),!1},this.clearAlert=function(a,b){this.trigger("uiAlertBannerClose"),this.$node.hide()},this.alertCancelFailure=function(a,b){var c;try{c=JSON.parse(b.responseText).errorForFlash}catch(d){c=_('Whoops! Something went wrong. Please refresh the page and try again!')}this.trigger("uiAlertBanner",{message:c})},this.alertResendSuccess=function(a,b){this.trigger("uiAlertBanner",{message:b.messageForFlash})},this.alertResendFailure=function(a,b){this.trigger("uiAlertBanner",{message:_('Whoops! Something went wrong. Please refresh the page and try again!')})},this.after("initialize",function(){this.on(this.$node.find(this.attr.cancelSelector),"click",this.cancelEmail),this.on(this.$node.find(this.attr.resendSelector),"click",this.resendEmail),this.on(document,"dataCancelEmailSuccess",this.clearAlert),this.on(document,"dataCancelEmailFailure",this.alertCancelFailure),this.on(document,"dataResendEmailSuccess",this.alertResendSuccess),this.on(document,"dataResendEmailFailure",this.alertResendFailure)})}var defineComponent=require("core/component"),_=require("core/i18n"),EmailConfirmationListener=defineComponent(emailConfirmationListener);module.exports=EmailConfirmationListener
});
define("app/ui/settings/tweet_export",["module","require","exports","core/component","app/data/with_scribe","core/utils","core/i18n"],function(module, require, exports) {
function tweetExport(){this.defaultAttrs({exportButtonSelector:"#export_button",resendButtonSelector:"#export_resend_button",exportDivSelector:"#export_request",resendDivSelector:"#export_resend",exportReadySelector:"#export_ready",exportInQueueSelector:"#export_in_queue",exportResendInstructionsSelector:"#export_resend_instructions",exportResendSuccessSelector:"#export_resend_success"}),this.scribeContext={component:"tweet_export"},this.scribeEvent=function(a){this.scribe(utils.merge(this.scribeContext,a))},this.exportInfo=function(a){this.scribeEvent({element:"export_button",action:"click"}),this.trigger("uiTweetExportButtonClicked",{})},this.resendExportInfo=function(){this.select("resendButtonSelector").is(":not(:disabled)")&&(this.scribeEvent({element:"export_resend_button",action:"click"}),this.trigger("uiTweetExportResendButtonClicked",{}))},this.exportSuccess=function(a,b){this.select("exportButtonSelector").is(":not(:disabled)")&&(b.result=="success"&&(this.select("exportButtonSelector").attr("disabled",!0),this.select("exportReadySelector").hide(),this.select("exportInQueueSelector").show()),this.trigger("uiNeedsTweetExportDialog",[b.result]))},this.exportError=function(a,b){this.trigger("uiAlertBanner",{message:_('Sorry, there was a problem. Try again later.')})},this.handleResendExportResendEmailResponse=function(a,b){this.trigger("uiShowMessage",{message:b}),a&&(this.select("resendButtonSelector").attr("disabled",!0),this.select("exportResendInstructionsSelector").hide(),this.select("exportResendSuccessSelector").show())},this.resendExportResendEmailSuccess=function(a,b){this.handleResendExportResendEmailResponse(b.result,b.messageForFlash)},this.resendExportResendEmailFailure=function(a,b){this.handleResendExportResendEmailResponse(!1,_('Oops! There was an error sending the email.'))},this.requestAlreadySent=function(a,b){this.select("exportDivSelector").hide(),this.select("resendDivSelector").show()},this.requestInQueue=function(a,b){this.select("resendDivSelector").hide(),this.select("exportDivSelector").show(),this.select("exportButtonSelector").attr("disabled",!0),this.select("exportReadySelector").hide(),this.select("exportInQueueSelector").show()},this.after("initialize",function(){this.on(document,"dataTweetExportSuccess",this.exportSuccess),this.on(document,"dataTweetExportError",this.exportError),this.on(document,"dataTweetExportResendSuccess",this.resendExportResendEmailSuccess),this.on(document,"dataTweetExportResendError",this.resendExportResendEmailFailure),this.on(document,"dataTweetExportRequestAlreadySent",this.requestAlreadySent),this.on(document,"dataTweetExportRequestInQueue",this.requestInQueue),this.on("click",{exportButtonSelector:this.exportInfo,resendButtonSelector:this.resendExportInfo})})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),utils=require("core/utils"),_=require("core/i18n"),TweetExport=defineComponent(tweetExport,withScribe);module.exports=TweetExport
});
define("app/ui/dialogs/tweet_export_dialog",["module","require","exports","core/component","core/utils","app/data/with_scribe","app/ui/with_dialog","app/ui/with_position","app/data/with_data"],function(module, require, exports) {
function tweetExportDialog(){this.defaultAttrs({successSelector:".tweet-export-success",serviceUnavailableSelector:".tweet-export-unavailable",suspendedUserSelector:".tweet-export-suspended-user",confirmEmailRequestSelector:".tweet-export-confirm-email-request",confirmEmailErrorSelector:".tweet-export-confirm-email-error",requestInQueueSelector:".tweet-export-request-in-queue",requestAlreadySentSelector:".tweet-export-request-already-sent",resendConfirmationSelector:"#resend_confirmation_button",thanksSelector:"#thanks_button",okaySelector:"#okay_button",spinnerSelector:"#email_sending_spinner",emailSentSelector:"#email_sent_text",resetHideSelector:".reset-hide"}),this.scribeContext={component:"tweet_export_dialog"},this.scribeEvent=function(a){this.scribe(utils.merge(this.scribeContext,a))},this.reset=function(){this.select("resetHideSelector").hide()},this.openDialog=function(a,b){this.reset(),this.open();switch(b){case"success":this.select("successSelector").show();break;case"unavailable":this.select("serviceUnavailableSelector").show();break;case"confirm_email_request":this.select("confirmEmailRequestSelector").show();break;case"request_in_queue":this.select("requestInQueueSelector").show(),this.trigger("dataTweetExportRequestInQueue");break;case"request_already_sent":this.select("requestAlreadySentSelector").show(),this.trigger("dataTweetExportRequestAlreadySent");break;case"suspended_user":this.select("suspendedUserSelector").show(),this.select("thanksSelector").show();break;default:this.select("serviceUnavailableSelector").show()}this.trigger(this.$dialog,"uiDialogContentChanged"),this.scribeEvent({element:b,action:"impression"})},this.resendConfirmationEmail=function(){this.scribeEvent({element:"resend_confirmation_button",action:"click"}),this.select("resendConfirmationSelector").hide(),this.select("spinnerSelector").show(),this.trigger("uiTweetExportConfirmEmail"),this.trigger(this.$dialog,"uiDialogContentChanged")},this.emailConfirmSuccess=function(a,b){this.select("spinnerSelector").hide(),this.select("emailSentSelector").show(),this.trigger(this.$dialog,"uiDialogContentChanged")},this.emailConfirmError=function(a,b){this.select("confirmEmailRequestSelector").hide(),this.select("confirmEmailErrorSelector").show(),this.select("spinnerSelector").hide(),this.select("resendConfirmationSelector").show(),this.trigger(this.$dialog,"uiDialogContentChanged")},this.closeDialog=function(a,b){this.close()},this.after("initialize",function(){this.on(document,"uiNeedsTweetExportDialog",this.openDialog),this.on(document,"dataResendConfirmationEmailSuccess",this.emailConfirmSuccess),this.on(document,"dataResendConfirmationEmailError",this.emailConfirmError),this.on("click",{resendConfirmationSelector:this.resendConfirmationEmail,thanksSelector:this.closeDialog,okaySelector:this.closeDialog}),this.before("close",function(){this.select("resendConfirmationSelector").is(":visible")&&this.scribeEvent({element:"confirm_email",action:"close"})})})}var defineComponent=require("core/component"),utils=require("core/utils"),withScribe=require("app/data/with_scribe"),withDialog=require("app/ui/with_dialog"),withPosition=require("app/ui/with_position"),withData=require("app/data/with_data"),TweetExportDialog=defineComponent(tweetExportDialog,withScribe,withDialog,withPosition,withData);module.exports=TweetExportDialog
});
define("app/ui/timezone_detector",["module","require","exports","core/component"],function(module, require, exports) {
function timezoneDetector(){this.selectTimezone=function(){var b=this.node;if(b[b.selectedIndex].getAttribute("selected")!==null)return;var c=this.tzOffset();for(var d=0;d<b.length;d++)if(parseInt(b[d].getAttribute("data-offset"))===c){$(b[d]).attr("selected","");return}},this.tzOffset=function(){return(new Date).getTimezoneOffset()*60*-1},this.after("initialize",function(){this.selectTimezone()})}var defineComponent=require("core/component"),TimezoneDetector=defineComponent(timezoneDetector);module.exports=TimezoneDetector
});
define("app/ui/deactivated",["module","require","exports","core/component"],function(module, require, exports) {
function deactivated(){this.deactivate=function(){return alert(this.attr.message),!1},this.after("initialize",function(){this.on("click",this.deactivate)})}var defineComponent=require("core/component"),Deactivated=defineComponent(deactivated);module.exports=Deactivated
});
define("app/ui/settings_controls",["module","require","exports","core/component","app/ui/with_interaction_data"],function(module, require, exports) {
function settingsControls(){this.defaultAttrs({submitSelector:"#settings_save",emailFollowStateButtonSelector:".email-follow-state-button",emailFollowSettingsRealtimeSelector:".email-follow-settings-realtime",emailFollowSettingsDailySelector:".email-follow-settings-daily",extraEmailFollowSettingsSelector:"#extra-email-follow-settings"}),this.willRequirePassword=function(){return this.$node.hasClass("requires-password")},this.submitForm=function(a){return!this.dialogOpen&&this.willRequirePassword()?(this.dialogOpen=!0,this.trigger("uiOpenPasswordDialog"),a.preventDefault(),!1):(this.trigger("uiCloseDialog"),!0)},this.dialogClosed=function(){this.dialogOpen=!1},this.submit=function(){this.$node.submit()},this.handleEmailFollowStateButtonClick=function(a){a.preventDefault();var b=this.$node.find(this.attr.extraEmailFollowSettingsSelector),c=b.attr("data-fid"),d={followerId:c};b.hasClass("email-follow-enabled")?this.trigger("uiDisableEmailFollowAction",d):this.trigger("uiEnableEmailFollowAction",d)},this.handleEmailFollowSettingsRealtimeClick=function(a){var b=$(a.target).closest(".email-follow-settings");this.trigger("uiEmailFollowSettingsRealtimeAction",this.getEmailFollowSettingsAttrs(b))},this.handleEmailFollowSettingsDailyClick=function(a){var b=$(a.target).closest(".email-follow-settings");this.trigger("uiEmailFollowSettingsDailyAction",this.getEmailFollowSettingsAttrs(b))},this.enableEmailFollow=function(a){this.$node.find(this.attr.extraEmailFollowSettingsSelector).removeClass("email-follow-disabled").addClass("email-follow-enabled")},this.disableEmailFollow=function(a){this.$node.find(this.attr.extraEmailFollowSettingsSelector).removeClass("email-follow-enabled").addClass("email-follow-disabled")},this.after("initialize",function(){this.on("submit",this.submitForm),this.on("uiDialogClosed",this.dialogClosed),this.on(document,"uiSubmitSettings",this.submit),this.on(document,"uiEnableEmailFollowAction dataEnableEmailFollow",this.enableEmailFollow),this.on(document,"uiDisableEmailFollowAction dataDisableEmailFollow",this.disableEmailFollow),this.on("click",{emailFollowStateButtonSelector:this.handleEmailFollowStateButtonClick,emailFollowSettingsRealtimeSelector:this.handleEmailFollowSettingsRealtimeClick,emailFollowSettingsDailySelector:this.handleEmailFollowSettingsDailyClick})})}var defineComponent=require("core/component"),withInteractionData=require("app/ui/with_interaction_data"),SettingsControls=defineComponent(settingsControls,withInteractionData);module.exports=SettingsControls
});
define("app/pages/settings/account",["module","require","exports","app/boot/settings","core/utils","app/data/settings/account_scribe","app/data/form_scribe","app/ui/password_dialog","app/ui/email_field_highlight","app/ui/validating_fieldset","app/ui/email_confirmation","app/ui/settings/tweet_export","app/ui/dialogs/tweet_export_dialog","app/ui/timezone_detector","app/ui/deactivated","app/ui/settings_controls","core/i18n"],function(module, require, exports) {
var settings=require("app/boot/settings"),utils=require("core/utils"),AccountScribe=require("app/data/settings/account_scribe"),FormScribe=require("app/data/form_scribe"),PasswordDialog=require("app/ui/password_dialog"),EmailFieldHighlight=require("app/ui/email_field_highlight"),ValidatingInputFieldSet=require("app/ui/validating_fieldset"),EmailConfirmation=require("app/ui/email_confirmation"),TweetExport=require("app/ui/settings/tweet_export"),TweetExportDialog=require("app/ui/dialogs/tweet_export_dialog"),TimezoneDetector=require("app/ui/timezone_detector"),Deactivated=require("app/ui/deactivated"),SettingsControls=require("app/ui/settings_controls"),_=require("core/i18n");module.exports=function(b){settings(b),AccountScribe.attachTo(document),FormScribe.attachTo("#account-form",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{language:"#user_lang",time_zone:"#user_time_zone",country:"#user_country",deactivate_account:"#account_deactivate_link",save:"#settings_save"}}),FormScribe.attachTo("#password_dialog",{eventData:{scribeContext:{component:"password_dialog"}},formElements:{password:"#auth_password",save:"#save_password",cancel:"#cancel_password_button"}}),ValidatingInputFieldSet.attachTo("#username_fieldset",{name:"Username",input:"#username",echoLabel:"#username_path",notification:"#username_notification",changeEvent:"uiUsernameChange",eventData:{scribeContext:{component:"form",element:"screen_name"}}}),ValidatingInputFieldSet.attachTo("#email_fieldset",{name:"Email",input:"#user_email",notification:"#email_notification",changeEvent:"uiEmailChange",eventData:{scribeContext:{component:"form",element:"email"}}}),EmailFieldHighlight.attachTo("#email_fieldset",b),EmailConfirmation.attachTo("#email-pending-group",{eventData:{scribeContext:{component:"form"}}}),PasswordDialog.attachTo("#password_dialog",utils.merge(b,{eventData:{scribeContext:{component:"password_dialog"}}})),TimezoneDetector.attachTo("#user_time_zone",{selectEvent:"uiTimezoneSelect"}),SettingsControls.attachTo("#account-form",{eventData:{scribeContext:{component:"form"}}}),TweetExport.attachTo("#tweet_export",b),TweetExportDialog.attachTo("#tweet_export_dialog",b),Deactivated.attachTo("#account_deactivate_link.deactivated",{message:_('Twitter is stressing out a bit right now, so this feature is temporarily disabled.')})}
});
define("app/data/settings/login_verification_test_run",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function loginVerificationTestRun(){this.sendTestSms=function(a,b){this.post({url:"/settings/security/attempt_login_verification_sms",data:{},success:"dataSendTestSmsSuccess",error:"dataSendTestSmsError"})},this.after("initialize",function(){this.on(document,"uiTestLoginVerificationSms",this.sendTestSms)})}var defineComponent=require("core/component"),withData=require("app/data/with_data"),LoginVerificationTestRun=defineComponent(loginVerificationTestRun,withData);module.exports=LoginVerificationTestRun
});
define("app/ui/settings/login_verification_sms_check",["module","require","exports","core/component","app/data/with_data","core/i18n"],function(module, require, exports) {
function loginVerificationSmsCheck(){this.defaultAttrs({loginVerificationRadioSelector:"#sms_login_verification",loginVerificationEnabledSelector:"#sms_login_verification_enabled",submitSelector:"#settings_save"}),this.checkLoginVerification=function(){this.$radio.prop("checked",!0)},this.openConfirmSmsDialog=function(a){if(this.select("loginVerificationEnabledSelector").val()=="true")return!0;this.trigger("uiOpenLoginVerificationConfirmationDialog"),this.$radio.prop("checked",!1),a.preventDefault()},this.after("initialize",function(){this.$radio=this.select("loginVerificationRadioSelector"),this.on("click",{loginVerificationRadioSelector:this.openConfirmSmsDialog}),this.on(document,"uiCheckLoginVerification",this.checkLoginVerification)})}var defineComponent=require("core/component"),withData=require("app/data/with_data"),_=require("core/i18n"),LoginVerificationSmsCheck=defineComponent(loginVerificationSmsCheck,withData);module.exports=LoginVerificationSmsCheck
});
define("app/ui/login_verification_confirmation_dialog",["module","require","exports","core/component","app/ui/with_dialog","app/ui/with_position","core/i18n"],function(module, require, exports) {
function loginVerificationConfirmationDialog(){this.defaultAttrs({spinnerSelector:"#login_verification_test_sms_spinner",fixitSelector:".fix_action",saveSelector:".save_action",presendSelector:".pre-send",postsendSelector:".post-send",sendMessageSelector:".send_message_action"}),this.confirmSmsWorks=function(a){this.$sendButton.addClass("visuallyhidden"),this.$spinner.removeClass("visuallyhidden"),this.trigger(document,"uiTestLoginVerificationSms")},this.loginVerificationTestSmsSuccessPrompt=function(){this.$presendElements.addClass("visuallyhidden"),this.$postsendElements.removeClass("visuallyhidden"),this.$spinner.addClass("visuallyhidden")},this.loginVerificationTestSmsErrorNotify=function(){this.$spinner.addClass("visuallyhidden"),this.$sendButton.removeClass("visuallyhidden"),this.trigger("uiShowError",{message:_('We cannot enable login verification at this time.')})},this.redirectToDevices=function(){this.trigger("uiNavigate",{href:"/settings/devices?fix_lv_device=true"})},this.navigateToDevicesPage=function(a){this.isOpen()&&this.close(),this.redirectToDevices(),a.preventDefault()},this.dialogClosed=function(){return this.$postsendElements.addClass("visuallyhidden"),this.$presendElements.removeClass("visuallyhidden"),!1},this.save=function(a){this.close(),this.trigger("uiCheckLoginVerification"),this.trigger("uiSubmitSettings"),a.preventDefault()},this.after("initialize",function(){this.$spinner=this.select("spinnerSelector"),this.$sendButton=this.select("sendMessageSelector"),this.$presendElements=this.select("presendSelector"),this.$postsendElements=this.select("postsendSelector"),this.on(document,"uiOpenLoginVerificationConfirmationDialog",this.open),this.on("uiDialogClosed",this.dialogClosed),this.on(document,"dataSendTestSmsSuccess",this.loginVerificationTestSmsSuccessPrompt),this.on(document,"dataSendTestSmsError",this.loginVerificationTestSmsErrorNotify),this.on("click",{fixitSelector:this.navigateToDevicesPage,saveSelector:this.save,sendMessageSelector:this.confirmSmsWorks})})}var defineComponent=require("core/component"),withDialog=require("app/ui/with_dialog"),withPosition=require("app/ui/with_position"),_=require("core/i18n"),LoginVerificationConfirmationDialog=defineComponent(loginVerificationConfirmationDialog,withDialog,withPosition);module.exports=LoginVerificationConfirmationDialog
});
define("app/ui/protected_verified_dialog",["module","require","exports","core/component","app/ui/with_dialog","app/ui/with_position"],function(module, require, exports) {
function protectedDialog(){this.defaultAttrs({dialogSelector:"#protected_verified_dialog",checkboxSelector:"#user_protected",stayVerifiedSelector:"#stay_verified_link",protectMyTweetsSelector:"#protect_my_tweets_link"}),this.warnVerifiedAccounts=function(){if(this.attr.userVerified&&this.select("checkboxSelector").attr("checked"))return this.open(),!1},this.dontProtectTweets=function(a){this.select("checkboxSelector").attr("checked",!1),a.preventDefault(),this.close()},this.protectTweets=function(a){this.select("checkboxSelector").attr("checked",!0),a.preventDefault(),this.close()},this.after("initialize",function(){this.$dialog=this.select("dialogSelector"),this.on(this.attr.checkboxSelector,"click",this.warnVerifiedAccounts),this.on(this.attr.stayVerifiedSelector,"click",this.dontProtectTweets),this.on(this.attr.protectMyTweetsSelector,"click",this.protectTweets)})}var defineComponent=require("core/component"),withDialog=require("app/ui/with_dialog"),withPosition=require("app/ui/with_position"),ProtectedDialog=defineComponent(protectedDialog,withDialog,withPosition);module.exports=ProtectedDialog
});
define("app/ui/geo_deletion",["module","require","exports","core/component","core/i18n"],function(module, require, exports) {
function geoDeletion(){this.defaultAttrs({confirmFunction:function(a){return window.confirm(a)},buttonSelector:"#geo_button",deleteInfoSelector:"#delete_geo_info",deletingDataSelector:"#deleting_geo_data"}),this.deleteGeo=function(a){if(this.attr.confirmFunction(this.attr.message))return this.select("deleteInfoSelector").hide(),this.select("deletingDataSelector").show(),this.trigger("uiDeleteGeoData"),!1},this.showDeletionError=function(){this.select("deleteInfoSelector").show(),this.select("deletingDataSelector").hide(),this.trigger("uiAlertBanner",{message:_('Whoops! Something went wrong. Please refresh the page and try again!')})},this.after("initialize",function(){this.on(document,"dataGeoDeletionError",this.showDeletionError),this.on("click",{buttonSelector:this.deleteGeo})})}var defineComponent=require("core/component"),_=require("core/i18n"),GeoDeletion=defineComponent(geoDeletion);module.exports=GeoDeletion
});
define("app/pages/settings/security",["module","require","exports","app/boot/settings","core/utils","app/data/settings/account_scribe","app/data/settings/login_verification_test_run","app/data/form_scribe","app/ui/password_dialog","app/ui/settings/login_verification_sms_check","app/ui/login_verification_confirmation_dialog","app/ui/protected_verified_dialog","app/ui/geo_deletion","app/ui/settings_controls","core/i18n"],function(module, require, exports) {
var settings=require("app/boot/settings"),utils=require("core/utils"),SecurityScribe=require("app/data/settings/account_scribe"),LoginVerificationTestRun=require("app/data/settings/login_verification_test_run"),FormScribe=require("app/data/form_scribe"),PasswordDialog=require("app/ui/password_dialog"),LoginVerificationSmsCheck=require("app/ui/settings/login_verification_sms_check"),LoginVerificationConfirmationDialog=require("app/ui/login_verification_confirmation_dialog"),ProtectedDialog=require("app/ui/protected_verified_dialog"),GeoDeletion=require("app/ui/geo_deletion"),SettingsControls=require("app/ui/settings_controls"),_=require("core/i18n");module.exports=function(b){settings(b),SecurityScribe.attachTo(document),LoginVerificationTestRun.attachTo(document),FormScribe.attachTo("#account-form",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{email_discoverability:"#user_discoverable_by_email",geo_enabled:"#user_geo_enabled",display_sensitive_content:"#user_nsfw_view",contains_sensitive_content:"#user_nsfw_user","protected":"#user_protected",personalization:"#use_cookie_personalization",personalization_preview_link:".personalization-preview-link",personalization_support_link:".personalization-support-link",ads_personalization:"#allow_ads_personalization",allow_follower_dms:"#user_can_receive_direct_messages_from_all_followers",save:"#settings_save"}}),FormScribe.attachTo("#password_dialog",{eventData:{scribeContext:{component:"password_dialog"}},formElements:{password:"#auth_password",save:"#save_password",cancel:"#cancel_password_button"}}),ProtectedDialog.attachTo("#user_protected_fieldset",b),PasswordDialog.attachTo("#password_dialog",b,{eventData:{scribeContext:{component:"password_dialog"}}}),LoginVerificationSmsCheck.attachTo("#login_verification_controls",b,{eventData:{scribeContext:{component:"login_verification_sms_check"}}}),LoginVerificationConfirmationDialog.attachTo("#login_verification_confirmation_dialog",b,{eventData:{scribeContext:{component:"login_verification_confirmation_dialog"}}}),SettingsControls.attachTo("#account-form",{eventData:{scribeContext:{component:"form"}}}),GeoDeletion.attachTo("#delete_geo_data",{message:_('Are you sure you want to delete all of your location data?'),eventData:{scribeContext:{component:"form",element:"delete_geo_data"}}})}
});
define("app/data/settings/applications_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function applicationsScribe(){this.defaultAttrs({organization:"a.oauth-organization",applications:"#apps-stream .oauth-application"}),this.after("initialize",function(){this.on("dataOAuthRevokeResultSuccess",function(a,b){this.scribe({element:b.revoked?"revoke_access":"unrevoke_access",action:"click"},b,{item_names:[b.sourceEventData.token]})}),this.on(this.select("organization"),"click",function(a){var b=$(a.target).closest(".oauth-application").attr("id").replace("oauth_application_","");this.scribe({component:"oauth_app",element:"organization",action:"click"},{item_names:[b],url:a.target.getAttribute("href")})})})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),ApplicationsScribe=defineComponent(applicationsScribe,withScribe);module.exports=ApplicationsScribe
});
define("app/ui/oauth_revoker",["module","require","exports","core/component"],function(module, require, exports) {
function oauthRevoker(){this.defaultAttrs({buttonSelector:".revoke.btn"}),this.revoke=function(a,b){var c=a.target.id.replace("btn_oauth_application_","");this.trigger("uiRevokeClick",{token:c,twttr:!0}),a.preventDefault()},this.showResult=function(a,b){var c=this.$node.find("#oauth_application_"+b.sourceEventData.token);b.revoked?c.addClass("revoked"):c.removeClass("revoked"),c.find(this.attr.buttonSelector).text(b.label)},this.after("initialize",function(){this.on(this.attr.buttonSelector,"click",this.revoke),this.on(document,"dataOAuthRevokeResultSuccess",this.showResult)})}var defineComponent=require("core/component"),OAuthRevoker=defineComponent(oauthRevoker);module.exports=OAuthRevoker
});
define("app/pages/settings/applications",["module","require","exports","app/boot/settings","app/data/settings/applications_scribe","app/ui/oauth_revoker"],function(module, require, exports) {
var settings=require("app/boot/settings"),ApplicationsScribe=require("app/data/settings/applications_scribe"),OAuthRevoker=require("app/ui/oauth_revoker");module.exports=function(b){settings(b),ApplicationsScribe.attachTo(document,b),OAuthRevoker.attachTo("#apps-stream",{eventData:{scribeContext:{component:"oauth_app"}}})}
});
define("app/data/settings/confirm_deactivation_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function confirmDeactivationScribe(){this.after("initialize",function(){this.on("uiDialogClosed",function(a,b){b&&b.scribeContext&&b.scribeContext.component&&this.scribe("close",b)}),this.scribeOnEvent("uiDialogOpened","open"),this.scribeOnEvent("uiForgotPassword","click")})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),ConfirmDeactivationScribe=defineComponent(confirmDeactivationScribe,withScribe);module.exports=ConfirmDeactivationScribe
});
define("app/pages/settings/confirm_deactivation",["module","require","exports","app/boot/settings","app/data/settings/confirm_deactivation_scribe","app/data/form_scribe","app/ui/password_dialog","app/ui/settings_controls"],function(module, require, exports) {
var settings=require("app/boot/settings"),ConfirmDeactivationScribe=require("app/data/settings/confirm_deactivation_scribe"),FormScribe=require("app/data/form_scribe"),PasswordDialog=require("app/ui/password_dialog"),SettingsControls=require("app/ui/settings_controls");module.exports=function(b){settings(b),ConfirmDeactivationScribe.attachTo(document,b),FormScribe.attachTo("#confirm_deactivation_section",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{support_feedback:"#support_feedback",deactivate:"#settings_save",cancel:"#deactivate_account_cancel",resend_password:"#forgot_password"}}),FormScribe.attachTo("#deactivation_password_dialog",{eventData:{scribeContext:{component:"password_dialog"}},formElements:{password:"#auth_password",save:"#save_password",cancel:"#cancel_password_button"}}),PasswordDialog.attachTo("#deactivation_password_dialog",{eventData:{scribeContext:{component:"password_dialog"}}}),SettingsControls.attachTo("#confirm-deactivate-account-form",b)}
});
define("app/data/settings/design_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function designScribe(){this.after("initialize",function(){this.on("dataImageProcessingResult",function(a,b){b.status.indexOf("http")!=-1?this.scribe("success",b,{url:b.status}):this.scribe("failure",b,{message:b.status})}),this.on("uiThemePicked",function(a,b){this.scribe("select",b,{item_ids:[b.id]})}),this.on("uiColorPicked",function(a,b){var c=b.targetSelector=="#background_color"?"background_color":"link_color";this.scribe({component:"form",element:c,action:"change"},{item_names:[b.hex]})})})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),DesignScribe=defineComponent(designScribe,withScribe);module.exports=DesignScribe
});
deferred('$lib/jquery_color_picker.js', function() {
/*! Color picker Author: Stefan Petre www.eyecon.ro Dual licensed under the MIT and GPL licenses */(function($){var a=function(){var a={},b,c=65,d,e='<div class="colorpicker round"><div class="colorpicker_color"><div><div></div></div></div><div class="colorpicker_hue"><div></div></div><div class="colorpicker_new_color"></div><div class="colorpicker_current_color"></div><div class="colorpicker_hex"><input type="text" maxlength="6" size="6" class="round picker_hex" /></div><div class="colorpicker_rgb_r colorpicker_field"><input type="text" maxlength="3" size="3" class="round" /><span></span></div><div class="colorpicker_rgb_g colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_rgb_b colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_h colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_s colorpicker_field"><input type="text" maxlength="3" size="3" /><span></span></div><div class="colorpicker_hsb_b colorpicker_field"><input type="text" maxlength="3" size="3" class="round" /><span></span></div><button class="colorpicker_submit"></button></div>',f={eventName:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},color:"ff0000",livePreview:!0,flat:!1,submitText:"Done"},g=function(a,b){var c=N(a);$(b).data("colorpicker").fields.eq(1).val(c.r).end().eq(2).val(c.g).end().eq(3).val(c.b).end()},h=function(a,b){$(b).data("colorpicker").fields.eq(4).val(a.h).end().eq(5).val(a.s).end().eq(6).val(a.b).end()},i=function(a,b){$(b).data("colorpicker").fields.eq(0).val(P(a)).end()},j=function(a,b){$(b).data("colorpicker").selector.css("backgroundColor","#"+P({h:a.h,s:100,b:100})),$(b).data("colorpicker").selectorIndic.css({left:parseInt(150*a.s/100,10),top:parseInt(150*(100-a.b)/100,10)})},k=function(a,b){$(b).data("colorpicker").hue.css("top",parseInt(150-150*a.h/360,10))},l=function(a,b){$(b).data("colorpicker").currentColor.css("backgroundColor","#"+P(a))},m=function(a,b){$(b).data("colorpicker").newColor.css("backgroundColor","#"+P(a))},n=function(a){var b=a.charCode||a.keyCode||-1;if(b>c&&b<=90||b==32)return!1;var d=$(this).parent().parent();d.data("colorpicker").livePreview===!0&&o.apply(this)},o=function(a){var b=$(this).parent().parent(),c;this.parentNode.className.indexOf("_hex")>0?b.data("colorpicker").color=c=L(J(this.value)):this.parentNode.className.indexOf("_hsb")>0?b.data("colorpicker").color=c=H({h:parseInt(b.data("colorpicker").fields.eq(4).val(),10),s:parseInt(b.data("colorpicker").fields.eq(5).val(),10),b:parseInt(b.data("colorpicker").fields.eq(6).val(),10)}):b.data("colorpicker").color=c=M(I({r:parseInt(b.data("colorpicker").fields.eq(1).val(),10),g:parseInt(b.data("colorpicker").fields.eq(2).val(),10),b:parseInt(b.data("colorpicker").fields.eq(3).val(),10)})),a&&(g(c,b.get(0)),i(c,b.get(0)),h(c,b.get(0))),j(c,b.get(0)),k(c,b.get(0)),m(c,b.get(0)),b.data("colorpicker").onChange.apply(b,[c,P(c),N(c)])},p=function(a){var b=$(this).parent().parent();b.data("colorpicker").fields.parent().removeClass("colorpicker_focus")},q=function(){c=this.parentNode.className.indexOf("_hex")>0?70:65,$(this).parent().parent().data("colorpicker").fields.parent().removeClass("colorpicker_focus"),$(this).parent().addClass("colorpicker_focus")},r=function(a){var b=$(this).parent().find("input").focus(),c={el:$(this).parent().addClass("colorpicker_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:a.pageY,field:b,val:parseInt(b.val(),10),preview:$(this).parent().parent().data("colorpicker").livePreview};$(document).bind("mouseup",c,t),$(document).bind("mousemove",c,s),$(document).bind("mousedown",c,s)},s=function(a){return a.data.field.val(Math.max(0,Math.min(a.data.max,parseInt(a.data.val+a.pageY-a.data.y,10)))),a.data.preview&&o.apply(a.data.field.get(0),[!0]),!1},t=function(a){return o.apply(a.data.field.get(0),[!0]),a.data.el.removeClass("colorpicker_slider").find("input").focus(),$(document).unbind("mouseup",t),$(document).unbind("mousemove",s),$(document).unbind("mousedown",s),!1},u=function(a){var b={cal:$(this).parent(),y:$(this).offset().top};b.preview=b.cal.data("colorpicker").livePreview,$(document).bind("mouseup",b,w),$(document).bind("mousemove",b,v),$(document).bind("mousedown",b,v)},v=function(a){return o.apply(a.data.cal.data("colorpicker").fields.eq(4).val(parseInt(360*(150-Math.max(0,Math.min(150,a.pageY-a.data.y)))/150,10)).get(0),[a.data.preview]),!1},w=function(a){return g(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),i(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),$(document).unbind("mouseup",w),$(document).unbind("mousemove",v),$(document).unbind("mousedown",v),!1},x=function(a){var b={cal:$(this).parent(),pos:$(this).offset()};b.preview=b.cal.data("colorpicker").livePreview,$(document).bind("mouseup",b,z),$(document).bind("mousemove",b,y),$(document).bind("mousedown",b,y)},y=function(a){return o.apply(a.data.cal.data("colorpicker").fields.eq(6).val(parseInt(100*(150-Math.max(0,Math.min(150,a.pageY-a.data.pos.top)))/150,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(150,a.pageX-a.data.pos.left))/150,10)).get(0),[a.data.preview]),!1},z=function(a){return g(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),i(a.data.cal.data("colorpicker").color,a.data.cal.get(0)),$(document).unbind("mouseup",z),$(document).unbind("mousemove",y),$(document).unbind("mousedown",y),!1},A=function(a){$(this).addClass("colorpicker_focus")},B=function(a){$(this).removeClass("colorpicker_focus")},C=function(a){var b=$(this).parent(),c=b.data("colorpicker").color;return b.data("colorpicker").origColor=c,l(c,b.get(0)),b.data("colorpicker").onSubmit(c,P(c),N(c),b.data("colorpicker").el),a.preventDefault(),!1},D=function(a){var b=$("#"+$(this).data("colorpickerId"));b.data("colorpicker").onBeforeShow.apply(this,[b.get(0)]);var c=$(this).offset(),d=G(),e=c.top+this.offsetHeight,f=c.left;return e+176>d.t+d.h&&(e-=this.offsetHeight+176),f+356>d.l+d.w&&(f-=356),b.css({left:f+"px",top:e+"px"}),b.data("colorpicker").onShow.apply(this,[b.get(0)])!=0&&b.show(),$(document).bind("mousedown",{cal:b},E),!1},E=function(a){if(!F(a.data.cal.get(0),a.target,a.data.cal.get(0))){var b=P(a.data.cal.data("colorpicker").color);a.data.cal.data("colorpicker").onHide(a.data.cal.get(0),b)!=0&&a.data.cal.hide(),$(document).unbind("mousedown",E)}},F=function(a,b,c){if(a==b)return!0;if(a.contains)return a.contains(b);if(a.compareDocumentPosition)return!!(a.compareDocumentPosition(b)&16);var d=b.parentNode;while(d&&d!=c){if(d==a)return!0;d=d.parentNode}return!1},G=function(){var a=document.compatMode=="CSS1Compat";return{l:window.pageXOffset||(a?document.documentElement.scrollLeft:document.body.scrollLeft),t:window.pageYOffset||(a?document.documentElement.scrollTop:document.body.scrollTop),w:window.innerWidth||(a?document.documentElement.clientWidth:document.body.clientWidth),h:window.innerHeight||(a?document.documentElement.clientHeight:document.body.clientHeight)}},H=function(a){return{h:Math.min(360,Math.max(0,a.h)),s:Math.min(100,Math.max(0,a.s)),b:Math.min(100,Math.max(0,a.b))}},I=function(a){return{r:Math.min(255,Math.max(0,a.r)),g:Math.min(255,Math.max(0,a.g)),b:Math.min(255,Math.max(0,a.b))}},J=function(a){var b=6-a.length;if(b>0){var c=[];for(var d=0;d<b;d++)c.push("0");c.push(a),a=c.join("")}return a},K=function(a){var a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16);return{r:a>>16,g:(a&65280)>>8,b:a&255}},L=function(a){return M(K(a))},M=function(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;return b.b=d,d==0,b.s=d!=0?255*e/d:0,b.s!=0?a.r==d?b.h=(a.g-a.b)/e:a.g==d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1,b.h*=60,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b},N=function(a){var b={},c=Math.round(a.h),d=Math.round(a.s*255/100),e=Math.round(a.b*255/100);if(d==0)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;c==360&&(c=0),c<60?(b.r=f,b.b=g,b.g=g+h):c<120?(b.g=f,b.b=g,b.r=f-h):c<180?(b.g=f,b.r=g,b.b=g+h):c<240?(b.b=f,b.r=g,b.g=f-h):c<300?(b.b=f,b.g=g,b.r=g+h):c<360?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}},O=function(a){var b=[a.r.toString(16),a.g.toString(16),a.b.toString(16)];return $.each(b,function(a,c){c.length==1&&(b[a]="0"+c)}),b.join("")},P=function(a){return O(N(a))},Q=function(){var a=$(this).parent(),b=a.data("colorpicker").origColor;a.data("colorpicker").color=b,g(b,a.get(0)),i(b,a.get(0)),h(b,a.get(0)),j(b,a.get(0)),k(b,a.get(0)),m(b,a.get(0))};return{init:function(a){a=$.extend({},f,a||{});if(typeof a.color=="string")a.color=L(a.color);else if(a.color.r!=undefined&&a.color.g!=undefined&&a.color.b!=undefined)a.color=M(a.color);else{if(a.color.h==undefined||a.color.s==undefined||a.color.b==undefined)return this;a.color=H(a.color)}return this.each(function(){if(!$(this).data("colorpickerId")){var b=$.extend({},a);b.origColor=a.color;var c="collorpicker_"+parseInt(Math.random()*1e3);$(this).data("colorpickerId",c);var d=$(e).attr("id",c);b.flat?d.appendTo(this).show():d.appendTo(document.body),b.fields=d.find("input").bind("keyup",n).bind("change",o).bind("blur",p).bind("focus",q),d.find("span").bind("mousedown",r).end().find(">div.colorpicker_current_color").bind("click",Q),b.selector=d.find("div.colorpicker_color").bind("mousedown",x),b.selectorIndic=b.selector.find("div div"),b.el=this,b.hue=d.find("div.colorpicker_hue div"),d.find("div.colorpicker_hue").bind("mousedown",u),b.newColor=d.find("div.colorpicker_new_color"),b.currentColor=d.find("div.colorpicker_current_color"),d.data("colorpicker",b);var f=d.find(".colorpicker_submit");f.bind("mouseenter",A).bind("mouseleave",B).bind("click",C),f.text(b.submitText||"Done"),g(b.color,d.get(0)),h(b.color,d.get(0)),i(b.color,d.get(0)),k(b.color,d.get(0)),j(b.color,d.get(0)),l(b.color,d.get(0)),m(b.color,d.get(0)),b.flat?d.css({position:"relative",display:"block"}):$(this).bind(b.eventName,D)}})},showPicker:function(){return this.each(function(){$(this).data("colorpickerId")&&D.apply(this)})},hidePicker:function(){return this.each(function(){$(this).data("colorpickerId")&&$("#"+$(this).data("colorpickerId")).hide()})},setColor:function(a){if(typeof a=="string")a=L(a);else if(a.r!=undefined&&a.g!=undefined&&a.b!=undefined)a=M(a);else{if(a.h==undefined||a.s==undefined||a.b==undefined)return this;a=H(a)}return this.each(function(){if($(this).data("colorpickerId")){var b=$("#"+$(this).data("colorpickerId"));b.data("colorpicker").color=a,b.data("colorpicker").origColor=a,g(a,b.get(0)),h(a,b.get(0)),i(a,b.get(0)),k(a,b.get(0)),j(a,b.get(0)),l(a,b.get(0)),m(a,b.get(0))}})},rgb2hex:function(a){}}}();$.fn.extend({ColorPicker:a.init,ColorPickerHide:a.hidePicker,ColorPickerShow:a.showPicker,ColorPickerSetColor:a.setColor})})(jQuery)
});
define("app/ui/color_picker",["module","require","exports","core/component","core/i18n","$lib/jquery_color_picker.js"],function(module, require, exports) {
function colorPicker(){var a=$("body"),b=$(window);this.defaultAttrs({all:"*",offsetTop:0,offsetLeft:0,target:null,colorPickerSelector:"div.colorpicker",colorPickerContainerClass:"colorpicker-container"}),this.setElements=function(){if(this.$picker)return;this.$container=$("<div>").addClass(this.attr.colorPickerContainerClass).appendTo("body").ColorPicker({flat:!0,submitText:_('Done')}),this.$picker=this.$container.find(this.attr.colorPickerSelector),this.$picker.data("colorpicker").onSubmit=this.submit.bind(this),this.$trigger=$(this.$node),this.isInput=this.$trigger.is("input"),this.$target=this.attr.target?$(typeof this.attr.target=="function"?this.attr.target.call(this):this.attr.target):this.$trigger},this.attachEvents=function(){if(!this.isInput){$(document).on("click","#"+this.node.id,this.toggle.bind(this)),this.on(document,"uiShortcutEsc",this.hide);return}return this.$trigger.on("click",!1).on("focus",this.show.bind(this)).on("blur",function(){this.$trigger.data("color",this.$trigger.val())}.bind(this)).on("keydown",function(a){this.isShown&&(a.which==9||a.which==13)&&(this.$picker.find(".colorpicker_submit").click(),a.preventDefault())}.bind(this))},this.toggle=function(a){this[this.isShown?"hide":"show"](a)},this.show=function(a){var c;this.isShown=!0,this.isInput?(c=this.$trigger.offset(),c.top+=this.$target[0].offsetHeight):c={left:a.clientX+b.scrollLeft(),top:a.clientY+b.scrollTop()},this.$container.css({left:c.left+this.attr.offsetLeft,top:c.top+this.attr.offsetTop}).ColorPickerSetColor(this.$target.data("color")||"#000000").show()},this.hide=function(){this.isShown=!1,this.$container&&this.$container.hide()},this.submit=function(a,b,c,d){var e="#"+b;this.$target.data("color",e).val(e),this.trigger("uiColorPicked",{targetSelector:"#"+this.$trigger.attr("id"),hex:e}),this.hide()},this.after("initialize",function(){if(this.$node[0].type==="color")return;this.setElements(),this.attachEvents()}),this.before("teardown",function(){this.$container.remove()})}var defineComponent=require("core/component"),_=require("core/i18n");require("$lib/jquery_color_picker.js"),module.exports=defineComponent(colorPicker)
});
define("app/ui/design",["module","require","exports","core/component","app/ui/color_picker"],function(module, require, exports) {
function design(){this.defaultAttrs({colorInputIdSuffix:"_hex",colorAttribute:"data-color",validHexColorEx:/^#([a-f0-9]{6}|[a-f0-9]{3})$/i,backgroundColor:"#background_color",linksColor:"#links_color",colorPreview:"div.color-preview",imagePreview:"#background_image_preview",theme:"#user_profile_theme",removeBackground:"#background-delete-image",useBackgroundImage:"#user_profile_use_background_image",backgroundTile:"#user_profile_background_tile",defaultTheme:"#user_profile_default",backgroundImageUpload:"#background-image-upload",profileWashColorInput:".profile-wash-color input",profileBackgroundPositionInput:".controls.background-position input",pageContainer:"#page-container"}),this.updateColorFromText=function(a){var b=$(a.target),c=b.attr("data-type"),d={targetSelector:"#"+c,hex:b.val()};d.hex.match(this.attr.validHexColorEx)?(this.updateSwatch(a,d),this.updateThemeColor(a,d)):this.resetColorInput(c)},this.attachColorPickers=function(){ColorPicker.attachTo(this.attr.colorPreview,{offsetLeft:40,offsetTop:-100,target:function(){return"#"+this.$node.attr("id")+"_hex"}})},this.updateTheme=function(a,b){this.selectTheme(a,b),this.applySelectedTheme(a,b),this.useBackgroundImage(a,b)},this.updateBackgroundPosition=function(a,b){$("body").css("background-position",a.target.value+" 40px");var c=$(window).scrollTop();$(window).scrollTop(c-1).scrollTop(c)},this.selectTheme=function(a,b){this.select("theme").val(b.id),this.select("defaultTheme").val("true")},this.applySelectedTheme=function(a,b){this.select("backgroundTile").attr("checked",b.tiled),this.select("imagePreview").css("background-image","url("+b.image+")"),this.updateSwatch(null,{targetSelector:this.attr.backgroundColor,hex:b.backgroundColor}),this.updateSwatch(null,{targetSelector:this.attr.linksColor,hex:b.linkColor}),this.trigger("uiThemeChanged",b),this.trigger("uiImagePickerFileReady",{uploadType:"background"})},this.updateColors=function(a,b){this.updateSwatch(a,b),this.updateThemeColor(a,b)},this.updateSwatch=function(a,b){var c=b.targetSelector,d=b.hex;$(c).css("background-color",d),$(c+this.attr.colorInputIdSuffix).attr(this.attr.colorAttribute,d),$(c+this.attr.colorInputIdSuffix).val(d)},this.updateThemeColor=function(a,b){this.select("defaultTheme").val("false"),b.targetSelector==this.attr.backgroundColor?this.trigger("uiThemeChanged",{backgroundColor:b.hex}):b.targetSelector==this.attr.linksColor&&this.trigger("uiThemeChanged",{linksColor:b.hex})},this.resetColorInput=function(a){var b=$(a+this.attr.colorInputIdSuffix);b.val(b.attr(this.attr.colorAttribute))},this.useCustomBackgroundImage=function(){this.useBackgroundImage(!0),this.select("defaultTheme").val("false")},this.useBackgroundImage=function(){this.select("useBackgroundImage").val("true"),this.select("removeBackground").show()},this.removeBackgroundImage=function(a,b){this.select("useBackgroundImage").val("false"),this.select("removeBackground").hide(),this.select("imagePreview").css("background-image","none"),this.select("defaultTheme").val("false"),this.trigger("uiBackgroundRemoved")},this.tileBackground=function(a,b){this.trigger("uiImageTileChanged",{tiled:a.target.checked})},this.updateWashColor=function(a,b){$(this.attr.pageContainer).removeClass("black white").addClass(a.target.value)},this.after("initialize",function(){this.attachColorPickers(),this.on(document,"uiColorPicked",this.updateColors),this.on("input.input-color","blur",this.updateColorFromText),this.on("fileUploaded",this.useCustomBackgroundImage),this.on("uiThemePicked",this.updateTheme),this.on("click",{backgroundTile:this.tileBackground,removeBackground:this.removeBackgroundImage,profileWashColorInput:this.updateWashColor,profileBackgroundPositionInput:this.updateBackgroundPosition})})}var defineComponent=require("core/component"),ColorPicker=require("app/ui/color_picker"),Design=defineComponent(design);module.exports=Design
});
define("app/ui/theme_preview",["module","require","exports","core/component"],function(module, require, exports) {
function themePreview(){this.defaultAttrs({themeNode:"body",userBackgroundImageURL:"#user_profile_background_image_url",linksColorSelector:"#links_color_hex"}),this.changeTheme=function(a,b){b.image&&(this.themeNode.css({"background-image":"url("+b.image+")","background-repeat":b.tiled?"repeat":"no-repeat","background-attachment":b.tiled?"scroll":"fixed"}),this.select("userBackgroundImageURL").val(b.image)),b.backgroundColor&&this.themeNode.css("background-color",b.backgroundColor),b.linksColor&&this.setLinkColor(b.linksColor)},this.removeImage=function(a,b){this.themeNode.css("background-image","none")},this.tile=function(a,b){this.themeNode.css({"background-repeat":b.tiled?"repeat":"no-repeat","background-attachment":b.tiled?"scroll":"fixed"})},this.setLinkColor=function(a){this.trigger("uiOverrideUserCss",{color:a}),this.linkColorChanged=!0},this.revertLinkColor=function(){this.linkColorChanged&&this.setLinkColor(this.originalLinkColor)},this.after("initialize",function(){this.themeNode=$(this.attr.themeNode),this.originalLinkColor=this.select("linksColorSelector").val(),this.on("uiThemeChanged",this.changeTheme),this.on("uiBackgroundRemoved",this.removeImage),this.on("uiImageTileChanged",this.tile),this.on(document,"uiBeforePageChanged",this.revertLinkColor)}),this.after("teardown",function(){this.themeNode.attr("style","")})}var defineComponent=require("core/component"),ThemePreview=defineComponent(themePreview);module.exports=ThemePreview
});
define("app/utils/blend_hex_color",["module","require","exports"],function(module, require, exports) {
function hexColorToIntArray(a){if(!a)return null;var b=a.replace(THREE_GROUPS_OF_ONE_CHAR_REGEX,"$1$1$2$2$3$3");return b.match(SIX_HEX_DIGITS_REGEX)?b.match(GLOBAL_MATCH_TWO_CHARS_REGEX).map(function(a){return parseInt(a,16)}):null}function blendHexColor(a,b,c){var d=hexColorToIntArray(a),e=hexColorToIntArray(c),f=1-b;return d&&e&&d.map(function(a,c){var d=Math.floor(a*b+e[c]*f);return(d+256).toString(16).slice(1)}).join("")}var THREE_GROUPS_OF_ONE_CHAR_REGEX=/^(.)(.)(.)$/,SIX_HEX_DIGITS_REGEX=/^[0-9a-f]{6}$/i,GLOBAL_MATCH_TWO_CHARS_REGEX=/.{2}/g;module.exports=blendHexColor
});
define("app/ui/profile/override_user_css",["module","require","exports","core/component","template","app/utils/blend_hex_color"],function(module, require, exports) {
function overrideUserCss(){this.defaultAttrs({overrideUserCssSelector:"#user-style-me",isRosetta:!1}),this.override=function(a,b){var c=b.color.replace(LEADING_HASH_REGEX,""),d={style_namespace:"me",is_rosetta:this.attr.isRosetta,user_color_lightest:blendHexColor(c,.1,"fff"),user_color_lighter:blendHexColor(c,.25,"fff"),user_color_light:blendHexColor(c,.4,"fff"),user_color:c,user_color_dark:blendHexColor(c,.8,"000"),user_color_darker:blendHexColor(c,.6,"000"),profile_link_color:c,profile_pretty_link_color:blendHexColor(c,.4,"fff")},e=template.user_css_color.render(d);this.select("overrideUserCssSelector").remove(),$("head").append(e)},this.after("initialize",function(){this.on("uiOverrideUserCss",this.override)})}var defineComponent=require("core/component"),template=require("template"),blendHexColor=require("app/utils/blend_hex_color"),LEADING_HASH_REGEX=/^#/;module.exports=defineComponent(overrideUserCss)
});
define("app/ui/theme_picker",["module","require","exports","core/component"],function(module, require, exports) {
function themePicker(){this.defaultAttrs({backgroundColorAttribute:"data-background_color",linkColorAttribute:"data-link_color",imageAttribute:"data-image",tiledAttribute:"data-tiled",themeSelector:".theme",selectedTheme:".selected"}),this.pickTheme=function(a,b){var c=$(b.el);this.select("selectedTheme").removeClass("selected"),this.$node.find('[data-id="'+c.attr("data-id")+'"]').addClass("selected"),this.trigger("uiThemePicked",{id:c.attr("data-id"),backgroundColor:c.attr(this.attr.backgroundColorAttribute),linkColor:c.attr(this.attr.linkColorAttribute),image:c.attr(this.attr.imageAttribute),tiled:c.attr(this.attr.tiledAttribute)=="true"})},this.after("initialize",function(){this.on("click",{themeSelector:this.pickTheme})})}var defineComponent=require("core/component"),ThemePicker=defineComponent(themePicker);module.exports=ThemePicker
});
define("app/pages/settings/design",["module","require","exports","app/boot/settings","app/data/form_scribe","app/data/settings/design_scribe","app/ui/design","app/ui/theme_preview","app/ui/profile/override_user_css","app/ui/theme_picker","app/ui/image_uploader","app/ui/settings/change_photo","core/i18n"],function(module, require, exports) {
var Settings=require("app/boot/settings"),FormScribe=require("app/data/form_scribe"),DesignScribe=require("app/data/settings/design_scribe"),Design=require("app/ui/design"),ThemePreview=require("app/ui/theme_preview"),OverrideUserCss=require("app/ui/profile/override_user_css"),ThemePicker=require("app/ui/theme_picker"),ImageUploader=require("app/ui/image_uploader"),ChangePhoto=require("app/ui/settings/change_photo"),_=require("core/i18n");module.exports=function(b){Settings(b),DesignScribe.attachTo(document,b),FormScribe.attachTo("#design-form",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{themeleon_link:"#themeleon_link",background_upload:"#file",tile_background:"#user_profile_background_tile",remove_background:"#background-delete-image",background_color:"#background_color_hex",link_color:"#links_color_hex",save:"#settings_save"}}),Design.attachTo("#design-form"),OverrideUserCss.attachTo(document,{isRosetta:b.rosetta}),ThemePreview.attachTo(document),ThemePicker.attachTo("#design-form",{eventData:{scribeContext:{component:"form",element:"theme"}}}),ChangePhoto.attachTo("#choose-background",{uploadType:"background",chooseExistingSelector:"#background-choose-existing",deleteImageSelector:"#background-delete-image",eventData:{scribeContext:{component:"profile_image_upload"}}}),ImageUploader.attachTo("#choose-background",{eventData:{uploadType:"background"},maxSizeInBytes:b.profileBackgroundImageMaxKB*1024,fileTooBigMessage:_('Please select an image that is less than {{size}}',{size:b.profileBackgroundImageSize}),onError:function(){window.scrollTo(0,0)}})}
});
define("app/pages/settings/email_follow",["module","require","exports","app/boot/settings","app/boot/user_timeline","app/ui/settings_controls"],function(module, require, exports) {
var settings=require("app/boot/settings"),userTimelineBoot=require("app/boot/user_timeline"),SettingsControls=require("app/ui/settings_controls");module.exports=function(b){settings(b),userTimelineBoot(b,b.timeline_url,"user-email-follow","user"),SettingsControls.attachTo("#timeline",{eventData:{scribeContext:{component:"email_follow_global_switch"}}})}
});
define("app/ui/settings/tweet_export_download",["module","require","exports","core/component","app/data/with_scribe","core/utils"],function(module, require, exports) {
function tweetExportDownload(){this.defaultAttrs({buttonSelector:"#download_tweets",availableMsgSelector:"#dl_available_msg",unavailableMsgSelector:"#dl_unavailable_msg"}),this.scribeContext={component:"tweet_export_download"},this.scribeEvent=function(a){this.scribe(utils.merge(this.scribeContext,a))},this.downloadExportedTweets=function(a){!this.select("buttonSelector").attr("aria-disabled")&&!this.select("buttonSelector").hasClass("feature-unavailable")&&(this.scribeEvent({element:"download_tweets",action:"done"}),this.select("buttonSelector").attr("aria-disabled",!0),this.select("availableMsgSelector").hide(),this.select("unavailableMsgSelector").show(),document.location=this.select("buttonSelector").attr("href"))},this.downloadRatelimited=function(a){this.scribeEvent({element:"download_tweets",action:"rate_limit"}),this.select("buttonSelector").attr("aria-disabled",!0),this.select("availableMsgSelector").hide(),this.select("unavailableMsgSelector").show()},this.initiateDownload=function(a){return a.preventDefault(),this.select("buttonSelector").hasClass("feature-unavailable")?(this.scribeEvent({element:"download_tweets",action:"click"}),this.trigger("uiNeedsTweetExportDialog",["unavailable"])):this.select("buttonSelector").attr("aria-disabled")||(this.scribeEvent({element:"download_tweets",action:"click"}),this.trigger("uiTweetExportIncrRateLimiter")),!1},this.after("initialize",function(){this.on(document,"dataTweetExportDownloadSuccess",this.downloadExportedTweets),this.on(document,"dataTweetExportDownloadError",this.downloadRatelimited),this.on("click",{buttonSelector:this.initiateDownload})})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),utils=require("core/utils"),TweetExportDownload=defineComponent(tweetExportDownload,withScribe);module.exports=TweetExportDownload
});
define("app/pages/settings/tweet_export_download",["module","require","exports","app/boot/settings","app/data/settings/account_scribe","app/ui/settings/tweet_export_download","app/ui/dialogs/tweet_export_dialog"],function(module, require, exports) {
var settings=require("app/boot/settings"),AccountScribe=require("app/data/settings/account_scribe"),TweetExportDownload=require("app/ui/settings/tweet_export_download"),TweetExportDialog=require("app/ui/dialogs/tweet_export_dialog");module.exports=function(b){settings(b),AccountScribe.attachTo(document),TweetExportDownload.attachTo("#tweet_export_download",b),TweetExportDialog.attachTo("#tweet_export_dialog",b)}
});
define("app/ui/settings/notifications",["module","require","exports","core/component"],function(module, require, exports) {
function notificationsDropdown(){this.defaultAttrs({toggler:".email-preference"}),this.pickDropdownItem=function(a){var b=$(a.target),c=b.val(),d="#"+b.data("attribute");$(d).val(c),$(d).prop("checked",!0)},this.after("initialize",function(){this.on(this.attr.toggler,"change",this.pickDropdownItem)})}var defineComponent=require("core/component");module.exports=defineComponent(notificationsDropdown)
});
define("app/pages/settings/notifications",["module","require","exports","app/boot/settings","app/data/form_scribe","app/ui/settings/notifications"],function(module, require, exports) {
var settings=require("app/boot/settings"),FormScribe=require("app/data/form_scribe"),NotificationsDropdown=require("app/ui/settings/notifications");module.exports=function(b){settings(b),FormScribe.attachTo("#notifications-form",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{enable_dm_emails:"#send_new_direct_text_email",enable_mention_emails:"#send_mention_email",enable_follow_emails:"#send_new_friend_email",enable_listed_emails:"#send_listed_email",enable_fav_emails:"#send_favorited_email",enable_fav_mention_emails:"#send_favorited_mention_email",enable_retweet_emails:"#send_retweeted_email",enable_retweet_mention_emails:"#send_retweeted_mention_email",enable_newsletter_emails:"#send_email_newsletter",enable_account_update_emails:"#send_account_updates_email",enable_network_digest_emails:"#network_digest_schedule",enable_individual_follower_emails:"#send_individual_follower_emails",enable_fav_retweet_emails:"#send_favorited_retweet_email",enable_retweeted_retweet_emails:"#send_retweeted_retweet_email",enable_conversation_track_emails:"#send_conversation_track_email",save:"#settings_save"}});var c={toggler:".email-preference"};NotificationsDropdown.attachTo("#send-favorited-email-dropdown",c),NotificationsDropdown.attachTo("#send-favorite-mention-email-dropdown",c),NotificationsDropdown.attachTo("#send-retweeted-email-dropdown",c),NotificationsDropdown.attachTo("#send-retweet-mention-email-dropdown",c),NotificationsDropdown.attachTo("#send-mention-email-dropdown",c),NotificationsDropdown.attachTo("#network-digest-schedule-dropdown",c),NotificationsDropdown.attachTo("#send-favorited-retweet-email-dropdown",c),NotificationsDropdown.attachTo("#send-retweeted-retweet-email-dropdown",c)}
});
define("app/ui/password",["module","require","exports","core/component","app/ui/with_forgot_password"],function(module, require, exports) {
function passwordForm(){this.defaultAttrs({currentPassword:"#current_password",passwordInput:"input:password",forgotSelector:"#forgot_password",reminderSelector:"#reminder_sent"}),this.after("initialize",function(){this.select("passwordInput").val(""),this.select("currentPassword").focus()})}var defineComponent=require("core/component"),withForgotPassword=require("app/ui/with_forgot_password"),PasswordForm=defineComponent(passwordForm,withForgotPassword);module.exports=PasswordForm
});
define("app/ui/password_match_pair",["module","require","exports","core/component"],function(module, require, exports) {
function passwordMatchPair(){this.defaultAttrs({passwordSelector:"#user_password",passwordConfirmSelector:"#user_password_confirmation",feedbackSelector:"#password_match"}),this.showConfirmation=function(a){var b=this.select("passwordConfirmSelector");b.val()!=""&&(b.val()!=this.select("passwordSelector").val()?this.select("feedbackSelector").show():this.select("feedbackSelector").hide())},this.after("initialize",function(){this.on("keyup",this.showConfirmation)})}var defineComponent=require("core/component"),PasswordMatchPair=defineComponent(passwordMatchPair);module.exports=PasswordMatchPair
});
define("app/ui/with_password_strength",["module","require","exports","core/i18n"],function(module, require, exports) {
function withPasswordStrength(){this.defaultAttrs({minLength:6,requireStrong:!1,username:"",bannedPasswords:[]}),this.strength=function(b,c,d){function j(a,b){return b&&a.toLowerCase()===(""+b).toLowerCase()}function k(){return{score:0,message:_('Too Obvious'),reason:"obvious"}}function l(a,b){var c="";for(var d=0;d<b.length;d++){var e=!0;for(var f=0;f<a&&f+d+a<b.length;f++)e=e&&b.charAt(f+d)==b.charAt(f+d+a);f<a&&(e=!1),e?(d+=a-1,e=!1):c+=b.charAt(d)}return c}var e=0,c=c||this.attr.username;if(b.length<this.attr.minLength)return{score:b.length,message:_('Too Short'),reason:"tooshort"};if(j(b,c))return k();if(j(b,d))return k();if(this.attr.bannedPasswords.indexOf(b.toLowerCase())>-1)return k();if(this.attr.requireStrong){var f=10,g="# ` ~ ! @ $ % ^ & * ( ) - _ = + [ ] { } \\ | ; : ' \" , . < > / ?".split(" ");g=g.map(function(a){return"\\"+a}).join("");var h=["\\d","[a-z]","[A-Z]","["+g+"]"],i=h.map(function(a){return"(?=.*"+a+")"}).join("");if(!b.match(new RegExp("("+i+"){10,}")))return{score:0,message:_('Too Weak'),reason:"tooweak"}}e+=b.length*4,e+=(l(1,b).length-b.length)*1,e+=(l(2,b).length-b.length)*1,e+=(l(3,b).length-b.length)*1,e+=(l(4,b).length-b.length)*1,b.match(/(.*[0-9].*[0-9].*[0-9])/)&&(e+=5),b.match(/(.*[!@#$%^&*?_~].*[!@#$%^&*?_~])/)&&(e+=5),b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(e+=10),b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)&&(e+=15),b.match(/([!@#$%^&*?_~])/)&&b.match(/([0-9])/)&&(e+=15),b.match(/([!@#$%^&*?_~])/)&&b.match(/([a-zA-Z])/)&&(e+=15);if(b.match(/^\w+$/)||b.match(/^\d+$/))e-=10;return e<0&&(e=0),e>100&&(e=100),e<34?{score:e,message:_('Weak'),reason:"weak"}:e<50?{score:e,message:_('Good'),reason:"good"}:e<75?{score:e,message:_('Strong'),reason:"strong"}:{score:e,message:_('Very Strong'),reason:"verystrong"}},this.undoBannedPasswordROT13=function(){var a=[];for(var b=0,c=this.attr.bannedPasswords.length;b<c;b++)a.push(this.attr.bannedPasswords[b].replace(/[a-z]/gi,function(a){var b=a.charCodeAt(0),c=b+13;if(b<=90&&c>90||c>122)c-=26;return String.fromCharCode(c)}));this.attr.bannedPasswords=a},this.after("initialize",function(){this.attr.bannedPasswords.length&&this.undoBannedPasswordROT13()})}var _=require("core/i18n");module.exports=withPasswordStrength
});
define("app/ui/password_strength",["module","require","exports","core/component","app/ui/with_password_strength"],function(module, require, exports) {
function passwordStrengthField(){this.defaultAttrs({feedbackSelector:"#password_strength_feedback",inputSelector:"#user_password"}),this.hide=function(){this.select("feedbackSelector").hide()},this.checkStrength=function(a){var b=this.select("feedbackSelector"),c=this.select("inputSelector").val();c.length===0?b.hide():c.length&&b.show();if(c.length>0){var d=this.strength(c);b.text(d.message)}},this.after("initialize",function(){this.on("keyup",this.checkStrength),this.on("focus",this.checkStrength),this.on("blur",this.hide)})}var defineComponent=require("core/component"),withPasswordStrength=require("app/ui/with_password_strength"),PasswordStrengthField=defineComponent(passwordStrengthField,withPasswordStrength);module.exports=PasswordStrengthField
});
define("app/data/temporary_password",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function temporaryPasswordData(){this.generateTemporaryPassword=function(a,b){this.post({url:"/account/login_verification/temporary_password.json",dataType:"json",data:b,eventData:b,success:"dataTemporaryPasswordGenerated",error:"dataFailedToGenerateTemporaryPassword"})},this.after("initialize",function(){this.on("uiGenerateTemporaryPassword",this.generateTemporaryPassword)})}var defineComponent=require("core/component"),withData=require("app/data/with_data");module.exports=defineComponent(temporaryPasswordData,withData)
});
define("app/ui/dialogs/temporary_password_dialog",["module","require","exports","core/component","core/i18n","app/ui/with_position","app/ui/with_dialog","app/ui/with_forgot_password","app/data/with_scribe"],function(module, require, exports) {
function temporaryPasswordDialog(){this.defaultAttrs({temporaryPasswordSelector:"#temporary-password",temporaryPasswordFormSelector:"#temporary-password-form",forgotSelector:"#forgot_password",reminderSelector:"#reminder_sent",passwordSelector:"#auth_password",cancelSelector:"#cancel_password_button",generatePasswordSelector:"#save_password",closePasswordSelector:"#close_password",passwordEnterSelector:"#password_confirm",passwordRetrySelector:"#retry_password",passwordBoxSelector:"#show_app_password",failureSelector:"#show_failure",successSelector:"#show_success",resetDialogSelector:"#reset_dialog"}),this.generatePassword=function(){this.select("passwordEnterSelector").hide(),this.hideResultInfo(),this.showSpinner();var a={password:this.select("passwordSelector").val()};this.trigger("uiGenerateTemporaryPassword",a)},this.passwordGenerated=function(a,b){if(b["temporary_password"]==null)return this.passwordFailed(a,b);this.showTemporaryPassword(b.temporary_password)},this.passwordFailed=function(a,b){var c=b.error_status,d=_('Whoops! Something went wrong. Please try again!');c=="BadPassword"?(d=_('That\'s not the correct password. Try again.'),this.select("closePasswordSelector").show(),this.select("passwordRetrySelector").show()):c=="OverLimitLoginVerificationAttempts"?(d=_('That\'s too many incorrect passwords. Please try again later.'),this.select("closePasswordSelector").show()):(this.select("closePasswordSelector").show(),this.select("passwordRetrySelector").show()),this.hideSpinner(),this.select("failureSelector").text(d).show(),this.scribe({component:"temporary_password_dialog",action:"temp_pass_failure"},b,{error_status:b.error_status})},this.focusPassword=function(){this.select("passwordSelector").focus().val("")},this.blurPassword=function(){this.select("passwordSelector").blur()},this.showSpinner=function(){this.hideResultInfo(),this.select("temporaryPasswordSelector").text("").addClass("spinner").show(),this.select("passwordBoxSelector").show(),this.select("generatePasswordSelector").hide(),this.select("cancelSelector").hide()},this.hideResultInfo=function(){this.select("failureSelector").text("").hide(),this.select("successSelector").hide()},this.hideSpinner=function(){this.select("temporaryPasswordSelector").text("").removeClass("spinner").hide(),this.select("generatePasswordSelector").hide()},this.showTemporaryPassword=function(a){var b=[a.substring(0,4),a.substring(4,8),a.substring(8,12)].join(" ");this.select("temporaryPasswordSelector").removeClass("spinner").text(b).show(),this.select("successSelector").show(),this.select("closePasswordSelector").show(),this.select("generatePasswordSelector").hide()},this.resetPasswordDialog=function(){this.hideResultInfo(),this.hideSpinner(),this.select("passwordBoxSelector").hide(),this.select("closePasswordSelector").hide(),this.select("cancelSelector").show(),this.select("passwordEnterSelector").show(),this.select("passwordRetrySelector").hide(),this.select("generatePasswordSelector").show(),this.focusPassword()},this.formSubmitted=function(a,b){this.select("generatePasswordSelector").is(":visible")?this.generatePassword():this.select("passwordRetrySelector").is(":visible")?this.resetPasswordDialog():this.close(),a.preventDefault()},this.after("initialize",function(){this.on("click",{cancelSelector:this.close,closePasswordSelector:this.close,resetDialogSelector:this.resetPasswordDialog,forgotSelector:this.notifyForgotPassword}),this.on(this.select("temporaryPasswordFormSelector"),"submit",this.formSubmitted),this.on(document,"uiOpenTemporaryPasswordDialog",this.open),this.on(document,"dataForgotPasswordSuccess",this.notifyReminderSent),this.on(document,"dataTemporaryPasswordGenerated",this.passwordGenerated),this.on(document,"dataFailedToGenerateTemporaryPassword",this.passwordFailed),this.on("uiDialogOpened",this.focusPassword),this.on("uiDialogClosed",this.resetPasswordDialog)})}var defineComponent=require("core/component"),_=require("core/i18n"),withPosition=require("app/ui/with_position"),withDialog=require("app/ui/with_dialog"),withForgotPassword=require("app/ui/with_forgot_password"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(temporaryPasswordDialog,withDialog,withPosition,withForgotPassword,withScribe)
});
define("app/ui/temporary_password_button",["module","require","exports","core/component"],function(module, require, exports) {
function temporaryPasswordButton(){this.openTemporaryPasswordDialog=function(a){a&&a.preventDefault(),this.trigger(document,"uiOpenTemporaryPasswordDialog")},this.after("initialize",function(){this.on("click",this.openTemporaryPasswordDialog)})}var defineComponent=require("core/component");module.exports=defineComponent(temporaryPasswordButton)
});
define("app/pages/settings/password",["module","require","exports","app/boot/settings","app/data/form_scribe","app/ui/password","app/ui/password_match_pair","app/ui/password_strength","app/data/temporary_password","app/ui/dialogs/temporary_password_dialog","app/ui/temporary_password_button"],function(module, require, exports) {
var settings=require("app/boot/settings"),FormScribe=require("app/data/form_scribe"),PasswordForm=require("app/ui/password"),PasswordMatchPair=require("app/ui/password_match_pair"),PasswordStrength=require("app/ui/password_strength"),TemporaryPasswordData=require("app/data/temporary_password"),TemporaryPasswordDialog=require("app/ui/dialogs/temporary_password_dialog"),TemporaryPasswordButton=require("app/ui/temporary_password_button");module.exports=function(b){settings(b),FormScribe.attachTo("#password-form",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{current_password:"#current_password",resend_password:"#forgot_password",new_password:"#user_password",confirm_password:"#user_password_confirmation",save:"#settings_save"}}),TemporaryPasswordData.attachTo(document),TemporaryPasswordDialog.attachTo("#temporary-password-dialog"),TemporaryPasswordButton.attachTo("#temporary-password-btn"),PasswordForm.attachTo("#password-form",b),PasswordMatchPair.attachTo("#password-match-pair",b),PasswordStrength.attachTo("#password_strength",{feedbackSelector:"#password_strength_feedback",inputSelector:"#user_password",bannedPasswords:b.bannedPasswords,username:b.username,requireStrong:b.requireStrong})}
});
define("app/boot/avatar_uploading",["module","require","exports","app/ui/settings/change_photo","app/ui/image_uploader","app/ui/profile_image_monitor","app/ui/dialogs/profile_image_upload_dialog","app/utils/image","core/i18n"],function(module, require, exports) {
function initialize(a){var b={scribeContext:{component:"profile_image_upload"}};!a.forceLegacyAvatarUploading&&image.supportsCropper()?($(a.duckfaceFormSelector).show(),ImageUploader.attachTo(a.duckfacePhotoUploadSelector,{maxSizeInBytes:10485760,fileTooBigMessage:_('Please select a profile image that is less than 10 MB.'),uploadType:a.uploadType,forceHTML5FileUploader:a.forceHTML5FileUploader,eventData:b}),ChangePhoto.attachTo(a.duckfaceControlsSelector,{uploadType:a.uploadType,showDeleteSuccessMessage:a.showDeleteSuccessMessage,eventData:b}),ProfileImageUpload.attachTo("#profile_image_upload_dialog",{uploadType:a.uploadType,showSuccessMessage:a.showUploadSuccessMessage,eventData:b})):($(a.duckfaceFormSelector).remove(),$(a.legacyFormSelector).show(),ImageUploader.attachTo(a.legacyPhotoUploadSelector,{maxSizeInBytes:716800,fileTooBigMessage:_('Please select a profile image that is less than 700 KB.'),uploadType:a.uploadType,forceHTML5FileUploader:a.forceHTML5FileUploader,eventData:b})),ProfileImageMonitor.attachTo("#profile-image-controls",{eventData:{scribeContext:{component:"form"}}})}var ChangePhoto=require("app/ui/settings/change_photo"),ImageUploader=require("app/ui/image_uploader"),ProfileImageMonitor=require("app/ui/profile_image_monitor"),ProfileImageUpload=require("app/ui/dialogs/profile_image_upload_dialog"),image=require("app/utils/image"),_=require("core/i18n");module.exports=initialize
});
define("app/data/settings/profile_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function profileScribe(){this.after("initialize",function(){this.on("dataImageProcessingResult",function(a,b){b.status.indexOf("http")!=-1?this.scribe({component:"form",element:"avatar_upload",action:"success"},{url:b.status}):b.status!="processing"&&this.scribe({component:"form",element:"avatar_upload",action:"failure"},{message:b.status})}),this.scribeOnEvent("fileUploaded","attempt"),this.scribeOnEvent("uiFacebookButtonClick","click"),this.scribeOnEvent("uiFacebookButtonImpression","impression")})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),ProfileScribe=defineComponent(profileScribe,withScribe);module.exports=ProfileScribe
});
define("app/ui/settings/facebook_iframe_height_adjuster",["module","require","exports","core/component"],function(module, require, exports) {
function IFrameHeightAdjuster(){this.defaultAttrs({iframeSelector:"#fb-iframe",staticHeightClass:"fb-static-height"}),this.adjustIframeHeight=function(a){var b={};a.originalEvent&&(a=a.originalEvent);if(a.origin===window.location.protocol+"//"+window.location.host){if(typeof a.data=="string"&&a.data!="undefined"&&a.data!="[object Object]")try{b=JSON.parse(a.data)}catch(c){console.log("Failed to JSON.parse: "+a.data)}b.height&&(this.select("iframeSelector").css("height",b.height+"px"),this.select("iframeSelector").attr("data-facebook-frame-loaded","true"))}},this.after("initialize",function(){window.postMessage?this.on(window,"message",this.adjustIframeHeight):this.select("iframeSelector").addClass(this.attr.staticHeightClass)}),this.before("teardown",function(){this.off(window,"message",this.adjustIframeHeight)})}var defineComponent=require("core/component");module.exports=defineComponent(IFrameHeightAdjuster)
});
define("app/ui/field_edit_warning",["module","require","exports","core/component"],function(module, require, exports) {
function fieldEditWarning(){this.defaultAttrs({errorClass:"errors",restoreAttribute:"rel",field:"#user_url",undo:"#undo",warning:"div.warning"}),this.validate=function(a,b){var c=this.select("field");c.attr(this.attr.restoreAttribute)==c.val()?(c.removeClass(this.attr.errorClass),this.select("warning").hide()):(c.addClass(this.attr.errorClass),this.select("warning").show())},this.undo=function(a,b){var c=this.select("field");c.val(c.attr("rel")),c.removeClass(this.attr.errorClass),this.select("warning").hide()},this.after("initialize",function(){this.on(this.attr.field,"keyup",this.validate),this.on(this.attr.undo,"click",this.undo)})}var defineComponent=require("core/component"),FieldEditWarning=defineComponent(fieldEditWarning);module.exports=FieldEditWarning
});
define("app/ui/dialogs/in_product_help_dialog",["module","require","exports","core/component","app/ui/with_dialog","app/ui/with_position","app/data/with_scribe","app/data/ddg"],function(module, require, exports) {
function inProductHelpDialog(){this.defaultAttrs({helpfulSelector:"#helpful_button",notHelpfulSelector:"#not_helpful_button",inProductHelpSelector:"#profile_image_help",inProductHelpAnchor:"#",feedbackQuestionSelector:"#satisfaction_question",feedbackButtonsSelector:"#satisfaction_buttons",feedbackMessageSelector:"#satisfaction_feedback"}),this.openDialog=function(a){ddg.impression("in_product_help_profile_settings_page_300");var b=a.target.href;if(b.charAt(b.length-1)==this.attr.inProductHelpAnchor)return this.scribe({component:"profile_image",element:"learn_more_dialog",action:"impression"}),this.open(),!1;this.scribe({component:"profile_image",element:"learn_more_link",action:"click"})},this.voteHelpful=function(a){this.scribe({component:"profile_image",element:"learn_more_dialog",action:a?"helpful":"unhelpful"}),this.select("feedbackQuestionSelector").hide(),this.select("feedbackButtonsSelector").hide(),this.select("feedbackMessageSelector").fadeIn(),this.trigger(this.$dialog,"uiDialogContentChanged")},this.after("initialize",function(){this.on("click",{helpfulSelector:function(){this.voteHelpful(!0)},notHelpfulSelector:function(){this.voteHelpful(!1)}}),this.on(this.attr.inProductHelpSelector,"click",this.openDialog),this.select("feedbackMessageSelector").hide()})}var defineComponent=require("core/component"),withDialog=require("app/ui/with_dialog"),withPosition=require("app/ui/with_position"),withScribe=require("app/data/with_scribe"),ddg=require("app/data/ddg");module.exports=defineComponent(inProductHelpDialog,withDialog,withPosition,withScribe)
});
define("app/boot/header_upload",["module","require","exports","app/ui/dialogs/profile_image_upload_dialog","app/ui/profile_image_monitor","app/ui/settings/change_photo","app/ui/image_uploader","core/i18n"],function(module, require, exports) {
var ProfileImageUpload=require("app/ui/dialogs/profile_image_upload_dialog"),ProfileImageMonitor=require("app/ui/profile_image_monitor"),ChangePhoto=require("app/ui/settings/change_photo"),ImageUploader=require("app/ui/image_uploader"),_=require("core/i18n");module.exports=function(b){var c={scribeContext:{component:"header_image_upload"}};ProfileImageUpload.attachTo("#header_image_upload_dialog",{uploadType:"header",maskPadding:40,maximumWidth:1252,maximumHeight:626,imageNameSelector:"#choose-header div.photo-selector input.file-name",imageDataSelector:"#choose-header div.photo-selector input.file-data",eventData:c}),ChangePhoto.attachTo("#choose-header",{uploadType:"header",chooseExistingSelector:"#header-choose-existing",chooseWebcamSelector:"#header-choose-webcam",deleteImageSelector:"#header-delete-image",eventData:c}),ProfileImageMonitor.attachTo(".uploader-header",{uploadType:"header",isProcessingCookie:"header_processing_complete_key",thumbnailSelector:"#header_image_preview",deleteButtonSelector:"#remove_header",deleteFormSelector:"#profile_banner_delete_form",eventData:{scribeContext:{component:"form"}}}),ImageUploader.attachTo(".header-settings .uploader-image .photo-selector",{fileNameString:"user[profile_header_image_name]",fileDataString:"user[profile_header_image]",fileInputString:"user[profile_header_image]",uploadType:"header",maxSizeInBytes:1024e4,fileTooBigMessage:_('Please select an image that is less than 10MB.'),onError:function(){window.scrollTo(0,0)},eventData:c})}
});
define("app/ui/bio_box",["module","require","exports","core/component","app/ui/with_character_counter","app/utils/with_event_params","app/ui/with_text_polling"],function(module, require, exports) {
function profileBioArea(){this.defaultAttrs({bioBoxSelector:"#user_description",counterSelector:"span.user_description_count",eventParams:{type:"ProfileBio"}}),this.val=function(a){if(a==undefined)return this.$text.val();this.$text.val(a),this.detectUpdatedText()},this.hasFocus=function(){return document.activeElement===this.$text[0]},this.detectUpdatedText=function(){var a=this.$text.val();a!==this.prevText&&(this.prevText=a,this.trigger("uiTextChanged"))},this.after("initialize",function(){this.$text=this.select("bioBoxSelector")})}var defineComponent=require("core/component"),withCounter=require("app/ui/with_character_counter"),withEventParams=require("app/utils/with_event_params"),withTextPolling=require("app/ui/with_text_polling");module.exports=defineComponent(profileBioArea,withCounter,withEventParams,withTextPolling)
});
define("app/pages/settings/profile",["module","require","exports","app/boot/avatar_uploading","app/boot/settings","app/boot/user_completion_module","app/data/settings/profile_scribe","app/data/form_scribe","app/ui/settings/facebook_iframe_height_adjuster","app/ui/field_edit_warning","app/ui/dialogs/in_product_help_dialog","app/boot/header_upload","app/ui/bio_box","app/data/settings/profile_image_upload_scribe","core/utils"],function(module, require, exports) {
var avatarUploading=require("app/boot/avatar_uploading"),settings=require("app/boot/settings"),userCompletionModule=require("app/boot/user_completion_module"),ProfileScribe=require("app/data/settings/profile_scribe"),FormScribe=require("app/data/form_scribe"),IFrameHeightAdjuster=require("app/ui/settings/facebook_iframe_height_adjuster"),FieldEditWarning=require("app/ui/field_edit_warning"),InProductHelpDialog=require("app/ui/dialogs/in_product_help_dialog"),HeaderUpload=require("app/boot/header_upload"),ProfileBioArea=require("app/ui/bio_box"),ProfileImageUploadScribe=require("app/data/settings/profile_image_upload_scribe"),utils=require("core/utils");module.exports=function(b){settings(b),userCompletionModule(b),HeaderUpload(b),ProfileScribe.attachTo(document,{pageName:b.pageName,sectionName:b.sectionName}),FormScribe.attachTo("#profile-form",{eventData:{scribeContext:{component:"form"}},scribeFormSubmit:!0,formElements:{avatar_upload:"#profile_image_uploaded_data",full_name:"#user_name",location:"#user_location",url:"#user_url",description:"#user_description",undo:"#undo",save:"#settings_save"}}),avatarUploading({forceHTML5FileUploader:b.forceHTML5FileUploader,duckfaceFormSelector:"#duckface-uploader",duckfacePhotoUploadSelector:"#photo-choose-existing .photo-selector",duckfaceControlsSelector:"#choose-photo",legacyFormSelector:"#legacy-uploader",uploadType:"avatar",legacyPhotoUploadSelector:".uploader-avatar .photo-selector"}),ProfileImageUploadScribe.attachTo("#header_image_upload_dialog"),ProfileImageUploadScribe.attachTo("#profile_image_upload_dialog"),FieldEditWarning.attachTo("#user_web_fieldset"),ProfileBioArea.attachTo("#user_description_box",utils.merge(b,{maxLength:160,superwarnLength:150,warnLength:140})),InProductHelpDialog.attachTo("#in_product_help_dialog"),IFrameHeightAdjuster.attachTo(document)}
});
define("app/data/settings/facebook_proxy",["module","require","exports","core/component","app/data/with_data","core/i18n"],function(module, require, exports) {
function FacebookProxy(){this.defaultAttrs({ajaxSetup:{},facebook:{page:{requiredPermissions:[]},profile:{requiredPermissions:[]}},connected:{permissions:{granted:[],missing:[]},accounts:[]}}),this.logout=function(){this.trigger("fbApiLogoutLaunch"),FB.logout(this.logoutFBCB.bind(this))},this.logoutFBCB=function(){this.profile.id?this.trigger("fbStatusNotLoggedIn",this.status()):this.trigger("fbStatusNotConnected",this.status())},this.relogin=function(){this.trigger("fbApiLogoutLaunch"),FB.logout(this.reloginFBCB.bind(this))},this.reloginFBCB=function(a){this.trigger("fbApiLogoutDone"),a.status==="unknown"?this.trigger("fbLoginNeeded",this.status()):this.trigger("fbLogoutError",this.status({flash:_('Facebook reported an error. The error has been reported to our engineering team. Please try again as it might be a temporary problem.')}))},this.disconnect=function(){FB.api("/me/permissions","DELETE",this.disconnectFBCB.bind(this))},this.disconnectFBCB=function(a){this.trigger("fbDisconnectDone"),this.trigger("fbApiGetLoginStatusLaunch"),a&&typeof a=="boolean"?(this.resetProfileAndPage(),FB.getLoginStatus(this.statusCB.bind(this),!0)):FB.getLoginStatus(this.statusCB.bind(this),!0)},this.requiredPermissions=function(){return this.profile.id&&this.page.id?this.profile.requiredPermissions.concat(this.page.requiredPermissions):this.profile.requiredPermissions},this.changeProfileCrossposting=function(a,b){this.post({url:"/settings/facebook/profile_crossposting_changed",data:{profileAccessToken:this.profile.accessToken,crossPosting:b.crossPosting},timeout:this.attr.ajaxSetup.timeout,eventData:b,success:this.changeProfileCrosspostingSuccess.bind(this),error:this.changeProfileCrosspostingError.bind(this)})},this.changeProfileCrosspostingSuccess=function(a){this.updateProfilePageConnected(a),a.error?this.processErrorResponse(a,"fbProfileCrosspostingError"):this.trigger("fbProfileCrosspostingCompleted",this.status())},this.changeProfileCrosspostingError=function(a){this.triggerTwitterCommunicationError("fbProfileCrosspostingError",a.xhr.statusText)},this.triggerTwitterCommunicationError=function(a,b){this.trigger(a,this.status({flash:_('There was a communication error with Twitter: {{status}}',{status:b})}))},this.changePageCrossposting=function(a,b){this.post({url:"/settings/facebook/page_crossposting_changed",data:{profileAccessToken:this.profile.accessToken,pageId:b.pageId,crossPosting:b.crossPosting},eventData:b,timeout:this.attr.ajaxSetup.timeout,success:this.changePageCrosspostingSuccess.bind(this),error:this.changePageCrosspostingError.bind(this)})},this.changePageCrosspostingSuccess=function(a){this.updateProfilePageConnected(a),a.error?this.processErrorResponse(a,"fbPageCrosspostingError"):this.trigger("fbPageCrosspostingCompleted",this.status())},this.changePageCrosspostingError=function(a){this.triggerTwitterCommunicationError("fbPageCrosspostingError",a.xhr.statusText)},this.changeRetweetCrossposting=function(a,b){this.post({url:"/settings/facebook/retweet_crossposting_changed",data:{profileAccessToken:this.profile.accessToken,crossPosting:b.crossPosting},eventData:b,timeout:this.attr.ajaxSetup.timeout,success:this.changeRetweetCrosspostingSuccess.bind(this),error:this.changeRetweetCrosspostingError.bind(this)})},this.changeRetweetCrosspostingSuccess=function(a){this.updateProfilePageConnected(a),a.error?this.processErrorResponse(a,"fbRetweetCrosspostingError"):this.trigger("fbRetweetCrosspostingCompleted",this.status())},this.changeRetweetCrosspostingError=function(a){this.triggerTwitterCommunicationError("fbRetweetCrosspostingError",a.xhr.statusText)},this.login=function(){this.trigger("fbApiLoginLaunch"),FB.login(this.statusCB.bind(this),{scope:this.requiredPermissions().join(",")})},this.requestPagePermissions=function(){this.trigger("fbApiLoginLaunch"),FB.login(this.statusCB.bind(this),{scope:this.profile.requiredPermissions.concat(this.page.requiredPermissions).join(",")})},this.resetProfileAndPage=function(){delete this.profile.id,delete this.profile.name,this.profile.crossPosting=!1,this.profile.retweetCrossPosting=!1,delete this.page.id,this.page.crossPosting=!1},this.status=function(a){return $.extend({profile:this.profile,page:this.page,connected:this.connected},a||{})},this.checkPermissions=function(){this.connected.permissions.missing.length===0?this.trigger("fbPermissionsGranted",this.status()):this.connected.permissions.missing.some(function(a){return this.profile.requiredPermissions.indexOf(a)>-1}.bind(this))?this.trigger("fbPermissionsMissing",this.status()):this.trigger("fbPagePermissionsMissing",this.status())},this.statusCB=function(a){this.trigger("fbApiDone");switch(a.status){case"connected":a.authResponse.userID===""+this.profile.id?this.post({url:"/settings/facebook/reconnected",data:{profileAccessToken:a.authResponse.accessToken,missingPermissions:this.connected.permissions.missing},eventData:a,timeout:this.attr.ajaxSetup.timeout,success:this.reconnectedSuccess.bind(this),error:this.reconnectedError.bind(this)}):this.profile.id?(this.trigger("fbApiBatchLaunch"),FB.api("/","POST",{batch:[{method:"GET",relative_url:this.profile.id+"?fields=name"},{method:"GET",relative_url:"me?fields=name"}]},this.apiResponse.bind(this))):this.post({url:"/settings/facebook/connected",data:{profileId:a.authResponse.userID,profileAccessToken:a.authResponse.accessToken},eventData:a,timeout:this.attr.ajaxSetup.timeout,success:this.connectedSuccess.bind(this),error:this.connectedError.bind(this)});break;default:this.profile.id?this.trigger("fbStatusNotLoggedIn",this.status()):this.trigger("fbStatusNotConnected",this.status())}},this.apiResponse=function(a){this.trigger("fbApiBatchDone"),Array.isArray(a)&&a.length===2&&a.reduce(function(a,b){return a&&b.code===200},!0)?this.trigger("fbStatusConnectionMismatch",{profile:JSON.parse(a[0].body),connected:JSON.parse(a[1].body)}):(this.trigger("fbApiBatchError"),this.trigger("fbConnectionError",this.status({flash:_('Facebook reported an error. The error has been reported to our engineering team. Please try again as it might be a temporary problem.')})))},this.connectedSuccess=function(a){this.processSuccess(a,"fbConnectionError")},this.connectedError=function(a){this.triggerTwitterCommunicationError("fbConnectionError",a.xhr.statusText)},this.reconnectedSuccess=function(a){this.processSuccess(a,"fbReconnectionError")},this.reconnectedError=function(a){this.triggerTwitterCommunicationError("fbReconnectionError",a.xhr.statusText)},this.processSuccess=function(a,b){this.updateProfilePageConnected(a),a.error?this.processErrorResponse(a,b):(a.sourceEventData&&a.sourceEventData.authResponse&&(this.profile.accessToken=a.sourceEventData.authResponse.accessToken),this.checkPermissions())},this.updateProfilePageConnected=function(a){a.profile&&(this.profile.id=a.profile.id,this.profile.name=a.profile.name,this.profile.crossPosting=a.profile.cross_posting,this.profile.retweetCrossPosting=a.profile.retweet_cross_posting),a.page?(this.page.id=a.page.id,this.page.crossPosting=a.page.cross_posting):a.profile&&(delete this.page.id,this.page.crossPosting=!1),a.connected&&(this.connected=a.connected)},this.processErrorResponse=function(a,b){if(a.error)switch(a.error.code){case 1100:case 1110:this.trigger("fbApiGetLoginStatusLaunch"),FB.getLoginStatus(this.statusCB,!0);break;case 1200:this.trigger("fbConnectionConflict",this.status({html:a.html}));break;case 1210:this.resetProfileAndPage(),this.trigger("fbApiGetLoginStatusLaunch"),FB.getLoginStatus(this.statusCB,!0);break;case 1300:this.trigger("fbApiGetLoginStatusLaunch"),FB.getLoginStatus(this.statusCB,!0);break;case 1400:this.trigger(b,this.status({flash:_('There was a Twitter server error. The error has been reported to our engineering team. Please try again as it might be a temporary problem.')}));break;case 1500:case 1510:this.checkPermissions();break;default:a.error.code<1e3?this.trigger(b,this.status({flash:_('Facebook reported an error. The error has been reported to our engineering team. Please try again as it might be a temporary problem.')})):a.error.code>2e3&&a.error.code<3e3?this.trigger(b,this.status({flash:_('There was a communication error between Twitter and Facebook. The error has been reported to our engineering team. Please try again as it might be a temporary problem.')})):this.trigger(b,this.status({flash:_('There was a communication error with Twitter: {{status}}',{status:a.error.message})}))}},this.after("initialize",function(){this.profile=this.attr.facebook.profile,this.page=this.attr.facebook.page,this.connected=this.attr.connected,this.on("fbLogoutNeeded",this.logout),this.on("fbDisconnectNeeded",this.disconnect),this.on("fbLoginNeeded",this.login),this.on("fbReloginNeeded",this.relogin),this.on("fbPagePermissionsNeeded",this.requestPagePermissions),this.on("fbProfileCrosspostingChanged",this.changeProfileCrossposting),this.on("fbPageCrosspostingChanged",this.changePageCrossposting),this.on("fbRetweetCrosspostingChanged",this.changeRetweetCrossposting),FB.init({appId:this.attr.facebook.appId,status:!1}),this.trigger("fbApiGetLoginStatusLaunch"),FB.getLoginStatus(this.statusCB.bind(this),!0)})}var defineComponent=require("core/component"),withData=require("app/data/with_data"),_=require("core/i18n");module.exports=defineComponent(FacebookProxy,withData)
});
define("app/ui/settings/with_facebook_container",["module","require","exports"],function(module, require, exports) {
function withFacebookContainer(){this.defaultAttrs({facebookContainerSelector:".facebook-container"}),this.hideFacebookContainers=function(){$(this.attr.facebookContainerSelector).each(function(){$(this).addClass("hidden")})}}module.exports=withFacebookContainer
});
define("app/ui/settings/facebook_spinner",["module","require","exports","core/component","app/ui/settings/with_facebook_container"],function(module, require, exports) {
function FacebookSpinner(){this.show=function(a,b){this.hideFacebookContainers(),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.after("initialize",function(){this.on(document,"uiSwiftLoaded fbLoginNeeded fbPagePermissionsNeeded",this.show)})}var defineComponent=require("core/component"),withFacebookContainer=require("app/ui/settings/with_facebook_container");module.exports=defineComponent(FacebookSpinner,withFacebookContainer)
});
define("app/ui/settings/with_facebook_banner",["module","require","exports"],function(module, require, exports) {
function withFacebookBanner(){this.defaultAttrs({flashSelector:".flash",outerBannerSelector:".banner-outer",closeSelector:".pane-close"}),this.showFlashBanner=function(a){var b=this.select("flashSelector"),c=this.select("outerBannerSelector");a.flash?(b.text(a.flash),c.removeClass("hidden")):(b.text(""),c.addClass("hidden"))},this.after("initialize",function(){this.on(this.select("closeSelector"),"click",function(){this.select("outerBannerSelector").addClass("hidden"),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*")})})}module.exports=withFacebookBanner
});
define("app/ui/settings/facebook_login",["module","require","exports","core/component","core/utils","app/ui/settings/with_facebook_container","app/ui/settings/with_facebook_banner"],function(module, require, exports) {
function FacebookLogin(){this.defaultAttrs({loginBtnSelector:".btn"}),this.show=function(a,b){this.hideFacebookContainers(),this.showFlashBanner(b),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.loginNeeded=function(a){this.trigger("fbLoginNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"login_button"}},!0))},this.after("initialize",function(){this.on(document,"fbLogoutError fbConnectionError fbStatusNotLoggedIn",this.show),this.on(this.select("loginBtnSelector"),"click",this.loginNeeded)})}var defineComponent=require("core/component"),utils=require("core/utils"),withFacebookContainer=require("app/ui/settings/with_facebook_container"),withFacebookBanner=require("app/ui/settings/with_facebook_banner");module.exports=defineComponent(FacebookLogin,withFacebookContainer,withFacebookBanner)
});
define("app/ui/settings/facebook_connect",["module","require","exports","core/component","core/utils","app/ui/settings/with_facebook_container","app/ui/settings/with_facebook_banner"],function(module, require, exports) {
function FacebookConnect(){this.defaultAttrs({loginBtnSelector:".btn"}),this.show=function(a,b){this.hideFacebookContainers(),this.showFlashBanner(b),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.loginNeeded=function(){this.trigger("fbLoginNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"connect_button"}},!0))},this.after("initialize",function(){this.on(document,"fbReconnectionError fbStatusNotConnected",this.show),this.on(this.select("loginBtnSelector"),"click",this.loginNeeded)})}var defineComponent=require("core/component"),utils=require("core/utils"),withFacebookContainer=require("app/ui/settings/with_facebook_container"),withFacebookBanner=require("app/ui/settings/with_facebook_banner");module.exports=defineComponent(FacebookConnect,withFacebookContainer,withFacebookBanner)
});
define("app/ui/settings/facebook_missing_permissions",["module","require","exports","core/component","core/utils","app/ui/settings/with_facebook_container"],function(module, require, exports) {
function FacebookMissingPermissions(){this.defaultAttrs({listSelector:"#missing-permissions-list",grantPermissionsBtnSelector:"#grant-permissions-btn",disconnectBtnSelector:"#disconnect-btn",avatarSelector:".facebook-avatar"}),this.show=function(a,b){var c=this.select("listSelector"),d=b.connected,e;this.hideFacebookContainers(),c.find(".explanation").each(function(){$(this).addClass("hidden")}),d&&d.permissions&&(e=d.permissions,e.missing&&Array.isArray(e.missing)&&e.missing.forEach(function(a){c.find("."+a).removeClass("hidden")})),b.profile&&b.profile.id?this.select("avatarSelector").removeClass("blank").attr("src","//graph.facebook.com/"+b.profile.id+"/picture?type=square"):this.select("avatarSelector").addClass("blank"),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.loginNeeded=function(a){this.trigger("fbLoginNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"grant_permissions_button"}},!0))},this.disconnectNeeded=function(a){this.trigger("fbDisconnectNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"disconnect_button"}},!0))},this.after("initialize",function(){this.on(document,"fbPermissionsMissing",this.show),this.on(this.select("disconnectBtnSelector"),"click",this.disconnectNeeded),this.on(this.select("grantPermissionsBtnSelector"),"click",this.loginNeeded)})}var defineComponent=require("core/component"),utils=require("core/utils"),withFacebookContainer=require("app/ui/settings/with_facebook_container");module.exports=defineComponent(FacebookMissingPermissions,withFacebookContainer)
});
define("app/ui/settings/facebook_mismatched_connection",["module","require","exports","core/component","core/utils","app/ui/settings/with_facebook_container"],function(module, require, exports) {
function FacebookMismatchedConnection(){this.defaultAttrs({loginBtnSelector:".btn",profileNameSelector:".profile-name",profileImgSelector:".facebook-avatar",connectedNameSelector:".connected-name",connectedImgSelector:".connected-avatar"}),this.show=function(a,b){var c=this.select("connectedImgSelector"),d=this.select("profileImgSelector");this.hideFacebookContainers(),b.profile&&(this.select("profileNameSelector").text(b.profile.name),d.attr("src","//graph.facebook.com/"+b.profile.id+"/picture?type=square"),d.attr("title","Facebook: "+b.profile.name)),b.connected&&(this.select("connectedNameSelector").text(b.connected.name),c.attr("src","//graph.facebook.com/"+b.connected.id+"/picture?type=square"),c.attr("title","Facebook: "+b.connected.name)),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.relogin=function(a){this.trigger("fbReloginNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"login_button"}},!0))},this.after("initialize",function(){this.on(document,"fbStatusConnectionMismatch",this.show),this.on(this.select("loginBtnSelector"),"click",this.relogin)})}var defineComponent=require("core/component"),utils=require("core/utils"),withFacebookContainer=require("app/ui/settings/with_facebook_container");module.exports=defineComponent(FacebookMismatchedConnection,withFacebookContainer)
});
define("app/ui/settings/facebook_connection_conflict",["module","require","exports","core/component","core/utils","app/ui/settings/with_facebook_container"],function(module, require, exports) {
function FacebookConnectionConflict(){this.defaultAttrs({explanationSelector:".explanation",reloginBtnSelector:".fb-btn"}),this.show=function(a,b){this.hideFacebookContainers(),b&&b.html&&this.select("explanationSelector").html(b.html),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.reloginNeeded=function(){this.trigger("fbReloginNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"relogin_button"}},!0))},this.after("initialize",function(){this.on(document,"fbConnectionConflict",this.show),this.on(this.select("reloginBtnSelector"),"click",this.reloginNeeded)})}var defineComponent=require("core/component"),utils=require("core/utils"),withFacebookContainer=require("app/ui/settings/with_facebook_container");module.exports=defineComponent(FacebookConnectionConflict,withFacebookContainer)
});
define("app/ui/settings/facebook_connected",["module","require","exports","core/component","core/i18n","core/utils","app/ui/settings/with_facebook_container","app/ui/settings/with_facebook_banner"],function(module, require, exports) {
function FacebookConnected(){this.defaultAttrs({disconnectSelector:"#disconnect-link",profileImgSelector:".facebook-avatar",profileCheckBoxSelector:"#facebook-profile input[type=checkbox]",pageOptionSelection:"#facebook-page",pageGrantPermissionSelection:"#facebook-page a",pageCheckBoxSelector:"#facebook-page input[type=checkbox]",pageDropDownSelector:"#facebook-page .facebook-dropdown",retweetCheckBoxSelector:"#facebook-retweet input[type=checkbox]",optionSelector:".facebook-option"}),this.show=function(a,b){var c="0";this.hideFacebookContainers(),b.profile&&this.showProfile(b.profile),b.page&&(c=this.showPage(b.page)),b.connected&&this.showConnected(b.connected,c),this.showFlashBanner(b),window.postMessage&&window.parent.postMessage(JSON.stringify({height:this.$node.outerHeight(!0)}),"*"),this.$node.removeClass("hidden")},this.showPage=function(a,b){var c=this.select("pageCheckBoxSelector"),b=(a.id||0).toString();return c.attr("checked",a.crossPosting).attr("disabled",b==="0"),b},this.showProfile=function(a){var b=this.select("retweetCheckBoxSelector"),c=this.select("profileCheckBoxSelector");this.select("profileImgSelector").attr("src","//graph.facebook.com/"+a.id+"/picture?type=square").attr("title",_('Facebook: {{name}}',{name:a.name})),c.attr("checked",a.crossPosting).parents(this.attr.optionSelector).removeClass("xhr"),b.attr("checked",a.retweetCrossPosting).parents(this.attr.optionSelector).removeClass("xhr")},this.showConnected=function(a,b){var c=0,d,e,f=this.select("pageDropDownSelector"),g=f.find("option[value=0]")[0].text,h=this.select("pageOptionSelection");a.permissions&&a.permissions.granted.indexOf("manage_pages")>-1?(h.addClass("manage-pages").removeClass("no-manage-pages xhr"),a.accounts&&(f.html('<select><option value="0">'+g+"</option></select>"),d=f.find("select"),a.accounts.forEach(function(a){a.category!=="Application"&&(c+=1,e=$("<option></option>"),e.text(a.name),e.val(a.id),a.id===b&&e.attr("selected","selected"),d.append(e))}),c===0&&d.append('<option value="0">'+_('No pages available')+"</option>"))):h.addClass("no-manage-pages").removeClass("manage-pages xhr")},this.disconnectNeeded=function(){this.trigger("fbDisconnectNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"disconnect_link"}},!0))},this.profileCrossPostingChanged=function(){var a=this.select("profileCheckBoxSelector");a.parents(this.attr.optionSelector).addClass("xhr"),this.trigger("fbProfileCrosspostingChanged",utils.merge(this.attr.eventData,{crossPosting:a.prop("checked"),scribeContext:{element:"profile_check_box"}},!0))},this.pagePermissionsNeeded=function(){this.trigger("fbPagePermissionsNeeded",utils.merge(this.attr.eventData,{scribeContext:{element:"allow_page_access_link"}},!0))},this.pageCrossPostingChanged=function(){var a=this.select("pageDropDownSelector"),b=a.find("option:selected"),c=this.select("pageCheckBoxSelector"),d=b.val();a.parents(this.attr.optionSelector).addClass("xhr"),c.attr("disabled",d==="0").attr("checked",d!=="0"),this.trigger("fbPageCrosspostingChanged",utils.merge(this.attr.eventData,{pageId:d,crossPosting:c.prop("checked"),scribeContext:{element:"page_dropdown"}},!0))},this.togglePageCrossPosting=function(){var a=this.select("pageDropDownSelector"),b=a.find("option:selected"),c=this.select("pageCheckBoxSelector");c.parents(this.attr.optionSelector).addClass("xhr"),this.trigger("fbPageCrosspostingChanged",utils.merge(this.attr.eventData,{pageId:b.val(),crossPosting:c.prop("checked"),scribeContext:{element:"page_check_box"}},!0))},this.retweetCrossPostingChanged=function(){var a=this.select("retweetCheckBoxSelector");a.parents(this.attr.optionSelector).addClass("xhr"),this.trigger("fbRetweetCrosspostingChanged",utils.merge(this.attr.eventData,{crossPosting:a.prop("checked"),scribeContext:{element:"retweet_check_box"}},!0))},this.after("initialize",function(){this.on(document,"fbPermissionsGranted fbPagePermissionsMissing fbProfileCrosspostingCompleted fbProfileCrosspostingError fbPageCrosspostingCompleted fbPageCrosspostingError fbRetweetCrosspostingCompleted fbRetweetCrosspostingError",this.show),this.on(this.select("disconnectSelector"),"click",this.disconnectNeeded),this.on(this.select("profileCheckBoxSelector"),"click",this.profileCrossPostingChanged),this.on(this.select("pageGrantPermissionSelection"),"click",this.pagePermissionsNeeded),this.on(this.select("pageDropDownSelector"),"change",this.pageCrossPostingChanged),this.on(this.select("pageCheckBoxSelector"),"click",this.togglePageCrossPosting),this.on(this.select("retweetCheckBoxSelector"),"click",this.retweetCrossPostingChanged)})}var defineComponent=require("core/component"),_=require("core/i18n"),utils=require("core/utils"),withFacebookContainer=require("app/ui/settings/with_facebook_container"),withFacebookBanner=require("app/ui/settings/with_facebook_banner");module.exports=defineComponent(FacebookConnected,withFacebookContainer,withFacebookBanner)
});
define("app/data/settings/facebook_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function FacebookScribe(){this.after("initialize",function(){["fbLoginNeeded","fbReloginNeeded","fbDisconnectNeeded","fbPagePermissionsNeeded","fbProfileCrosspostingChanged","fbPageCrosspostingChanged","fbRetweetCrosspostingChanged"].forEach(function(a){this.scribeOnEvent(a,{action:"click"})},this),this.scribeOnEvent("fbApiLogoutLaunch",{component:"fb_api",element:"logout",action:"launch"}),this.scribeOnEvent("fbApiLogoutDone",{component:"fb_api",element:"logout",action:"done"}),this.scribeOnEvent("fbLogoutError",{component:"fb_api",element:"logout",action:"error"}),this.scribeOnEvent("fbStatusNotLoggedIn",{component:"fb_api",element:"logout",action:"done"}),this.scribeOnEvent("fbStatusNotConnected",{component:"fb_api",element:"logout",action:"done"}),this.scribeOnEvent("fbDisconnectNeeded",{component:"fb_api",element:"logout",action:"launch"}),this.scribeOnEvent("fbDisconnectDone",{component:"fb_api",element:"logout",action:"done"}),this.scribeOnEvent("fbApiLoginLaunch",{component:"fb_api",element:"login",action:"launch"}),this.scribeOnEvent("fbApiGetLoginStatusLaunch",{component:"fb_api",element:"get_login_status",action:"launch"}),this.scribeOnEvent("fbApiDone",{component:"fb_api",action:"done"}),this.scribeOnEvent("fbApiBatchLaunch",{component:"fb_api",element:"batch",action:"launch"}),this.scribeOnEvent("fbApiBatchDone",{component:"fb_api",element:"batch",action:"done"}),this.scribeOnEvent("fbApiBatchError",{component:"fb_api",element:"batch",action:"error"})})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe");module.exports=defineComponent(FacebookScribe,withScribe)
});
define("app/pages/settings/facebook",["module","require","exports","app/boot/common","app/data/settings/facebook_proxy","app/ui/settings/facebook_spinner","app/ui/settings/facebook_login","app/ui/settings/facebook_connect","app/ui/settings/facebook_missing_permissions","app/ui/settings/facebook_mismatched_connection","app/ui/settings/facebook_connection_conflict","app/ui/settings/facebook_connected","app/data/settings/facebook_scribe"],function(module, require, exports) {
var common=require("app/boot/common"),FacebookProxy=require("app/data/settings/facebook_proxy"),FacebookSpinner=require("app/ui/settings/facebook_spinner"),FacebookLogin=require("app/ui/settings/facebook_login"),FacebookConnect=require("app/ui/settings/facebook_connect"),FacebookMissingPermissions=require("app/ui/settings/facebook_missing_permissions"),FacebookMismatchedConnection=require("app/ui/settings/facebook_mismatched_connection"),FacebookConnectionConflict=require("app/ui/settings/facebook_connection_conflict"),FacebookConnected=require("app/ui/settings/facebook_connected"),FacebookScribe=require("app/data/settings/facebook_scribe");module.exports=function(b){common(b),FacebookSpinner.attachTo("#facebook-spinner"),FacebookLogin.attachTo("#facebook-login",{eventData:{scribeContext:{component:"login"}}}),FacebookConnect.attachTo("#facebook-connect",{eventData:{scribeContext:{component:"connect"}}}),FacebookMissingPermissions.attachTo("#facebook-missing-permissions",{eventData:{scribeContext:{component:"missing_permissions"}}}),FacebookMismatchedConnection.attachTo("#facebook-mismatched-connection",{eventData:{scribeContext:{component:"mismatched_connection"}}}),FacebookConnectionConflict.attachTo("#facebook-connection-conflict",{eventData:{scribeContext:{component:"connection_conflict"}}}),FacebookConnected.attachTo("#facebook-connected",{eventData:{scribeContext:{component:"connected"}}}),FacebookScribe.attachTo(document),FacebookProxy.attachTo(document,b)}
});
define("app/data/settings/sms_scribe",["module","require","exports","core/component","app/data/with_scribe"],function(module, require, exports) {
function smsScribe(){this.after("initialize",function(){this.scribeOnEvent("uiDialogOpened","open"),this.on("uiDialogClosed",function(a,b){b&&b.scribeContext&&b.scribeContext.component&&this.scribe("close",b)}),this.scribeOnEvent("uiForgotPassword","click")})}var defineComponent=require("core/component"),withScribe=require("app/data/with_scribe"),SmsScribe=defineComponent(smsScribe,withScribe);module.exports=SmsScribe
});
define("app/ui/forms/select_box",["module","require","exports","core/component"],function(module, require, exports) {
function selectBox(){this.clickItems=function(a,b){this.trigger("uiItemClick")},this.itemSelect=function(){var a,b={index:this.node.selectedIndex},c,d;if(this.node.selectedIndex>=0){d=this.node.options[this.node.selectedIndex];for(c=0;c<d.attributes.length;c++)a=d.attributes[c].name,b[a]=d.attributes[c].value;b.text=d.innerHTML}this.trigger("uiItemSelect",b)},this.setItems=function(a,b){this.$node.empty(),b.items&&b.items.forEach(function(a){var b=$("<option />"),c;for(c in a)c=="text"?b.html(a[c]):b.attr(c,a[c]);b.appendTo(this.$node)}.bind(this)),this.itemSelect()},this.after("initialize",function(){this.node.jquery&&(this.node=this.node[0]),this.attr.items&&this.node.trigger("setItems",{items:this.attr.items}),this.on("setItems",this.setItems),this.on("change",this.itemSelect),this.on("mousedown",this.clickItems)})}var defineComponent=require("core/component");module.exports=defineComponent(selectBox)
});
define("app/ui/settings/sms_phone_create_form",["module","require","exports","core/component","app/ui/forms/select_box","app/data/with_scribe","core/utils"],function(module, require, exports) {
function smsPhoneCreateForm(){this.defaultAttrs({carrierMessageJawwal:"#carrier-message-jawwal-ps",carrierMessageWataniya:"#carrier-message-wataniya-ps",carrierMessageNoMT:"#carrier-message-no-mt",carrierName:"#device_carrier_name",countryCodeDisplay:"#country_code_display",countryCodeValue:"#device_country_intl_prefix",chooseCarrier:"#choose-carrier",chooseCountry:"#choose-country",regionCountryCodeValue:"#region_country_code",regionsWithHiddenCarrier:[]}),this.clearCarrierMessage=function(){this.$carrierMessageJawwal.hide(),this.$carrierMessageWataniya.hide(),this.$carrierMessageNoMT.hide()},this.onUiCarrierChange=function(a,b){this.clearCarrierMessage(),b.value=="jawwal_ps"?this.$carrierMessageJawwal.show():b.value=="wataniya_ps"&&this.$carrierMessageWataniya.show(),(b.mt_limit==="0"||b.mt_sms_limit==="0")&&this.$carrierMessageNoMT.show(),this.$carrierName.attr("value",b.text)},this.onUiCountryChange=function(a,b){this.setCountry(b.text,b.value,b["data-region"]),this.selectTimer&&(clearTimeout(this.selectTimer),this.selectTimer=null)},this.onUiCountryClick=function(a){this.selectTimer||(this.selectTimer=setTimeout(function(){this.scribe({component:"country_dropdown",action:"click"}),this.selectTimer=null}.bind(this),3e3))},this.setCountry=function(a,b,c){this.$countryCodeDisplay.html(b),this.$countryCodeValue.attr("value",b),this.$regionCountryCodeValue.attr("value",c?b:""),this.countryName=a,this.updateCarrierList(c)},this.updateCarrierList=function(a){var b=this.attr.carrierInfo.carriers[this.countryName];if(!b){this.$carrierName.attr("value",""),this.trigger(this.$chooseCarrierSelect,"setItems",{}),this.$chooseCarrier.hide(),this.clearCarrierMessage();return}b=b.map(function(a){return a.display&&!a.text&&(a.text=a.display,delete a.display),a.features&&(a=utils.merge(a,a.features)),a}.bind(this)),this.trigger(this.$chooseCarrierSelect,"setItems",{items:b}),a&&this.attr.regionsWithHiddenCarrier.indexOf(a)>=0?this.$chooseCarrier.hide():this.$chooseCarrier.show()},this.after("initialize",function(){this.selectTimer=null,this.carrierInfo=this.attr.carrierInfo,this.$carrierMessageJawwal=this.select("carrierMessageJawwal"),this.$carrierMessageWataniya=this.select("carrierMessageWataniya"),this.$carrierMessageNoMT=this.select("carrierMessageNoMT"),this.$carrierName=this.select("carrierName"),this.$chooseCarrier=this.select("chooseCarrier"),this.$chooseCountry=this.select("chooseCountry"),this.$countryCodeValue=this.select("countryCodeValue"),this.$countryCodeDisplay=this.select("countryCodeDisplay"),this.$regionCountryCodeValue=this.select("regionCountryCodeValue"),this.$chooseCarrierSelect=this.select("chooseCarrier").find("select"),SelectBox.attachTo(this.$chooseCarrierSelect),this.on(this.$chooseCarrierSelect,"uiItemSelect",this.onUiCarrierChange),this.$chooseCountrySelect=this.select("chooseCountry").find("select"),SelectBox.attachTo(this.$chooseCountrySelect),this.on(this.$chooseCountrySelect,"uiItemClick",this.onUiCountryClick),this.on(this.$chooseCountrySelect,"uiItemSelect",this.onUiCountryChange),this.setCountry(this.attr.defaultCountry.country,this.attr.defaultCountry.code,null),this.$node.addClass("ready")})}var defineComponent=require("core/component"),SelectBox=require("app/ui/forms/select_box"),withScribe=require("app/data/with_scribe"),utils=require("core/utils");module.exports=defineComponent(smsPhoneCreateForm,withScribe)
});
define("app/ui/forms/element_group_toggler",["module","require","exports","core/component"],function(module, require, exports) {
function elementGroupToggler(){this.defaultAttrs({togglerSelector:".toggler",elementsSelector:".toggleable"}),this.toggleGroup=function(a){this.$elements.each(function(a,b){var c=this.$node.find(b);c.attr("disabled",c.is(":not(:disabled)"))}.bind(this))},this.after("initialize",function(){this.$elements=this.select("elementsSelector");if(this.select("togglerSelector").length>1)throw new Error("Only one togglerSelector is allowed per ElementGroup");this.on(this.select("togglerSelector"),"click",this.toggleGroup)})}var defineComponent=require("core/component");module.exports=defineComponent(elementGroupToggler)
});
define("app/ui/settings/device_verified_form",["module","require","exports","core/component","app/ui/password_dialog","app/ui/forms/element_group_toggler"],function(module, require, exports) {
function deviceVerifiedForm(){this.defaultAttrs({activityNotificationsFavorites:".activity-notifications-favs",activityNotificationsRetweets:".activity-notifications-rts",messageNotificationsMentions:".message-notifications-mentions",secureField:".secure-field",sleepSettings:".sleep-settings"}),this.toggleFormRequiresPassword=function(a){this.$node.toggleClass("requires-password")},this.after("initialize",function(){ElementGroupToggler.attachTo(this.select("activityNotificationsFavorites")),ElementGroupToggler.attachTo(this.select("activityNotificationsRetweets")),ElementGroupToggler.attachTo(this.select("messageNotificationsMentions")),ElementGroupToggler.attachTo(this.select("sleepSettings"));if(this.select("secureField").length>1)throw new Error("Only one secure field is currently supported on this form");this.on(this.select("secureField"),"click",this.toggleFormRequiresPassword),this.$node.addClass("ready")})}var defineComponent=require("core/component"),PasswordDialog=require("app/ui/password_dialog"),ElementGroupToggler=require("app/ui/forms/element_group_toggler");module.exports=defineComponent(deviceVerifiedForm)
});
define("app/ui/settings/sms_phone_verify_form",["module","require","exports","core/component","app/data/with_data"],function(module, require, exports) {
function smsPhoneVerifyForm(){this.defaultAttrs({pollUrl:"/devices/verify",pollInterval:1e4,reloadLink:"#reload"}),this.checkDeviceStatus=function(){this.get({url:this.attr.pollUrl,data:{device_id:this.attr.deviceId},cache:!1,success:this.deviceStatusCheckSuccess.bind(this),complete:this.deviceStatusCheckComplete.bind(this)})},this.deviceStatusCheckSuccess=function(a){var b;if(!a.verified&&!a.error)return;a.error?b="?timeout=true":b="?success=true",window.location=window.location.pathname+b},this.deviceStatusCheckComplete=function(){setTimeout(this.checkDeviceStatus.bind(this),this.attr.pollInterval)},this.reloadPage=function(a){var b;a.preventDefault(),b="?refresh=true",window.location=window.location.pathname+b},this.after("initialize",function(){this.$reloadLink=this.select("reloadLink"),this.on(this.$reloadLink,"click",this.reloadPage),this.checkDeviceStatus()})}var defineComponent=require("core/component"),withData=require("app/data/with_data"),SMSPhoneVerifyForm=defineComponent(smsPhoneVerifyForm,withData);module.exports=SMSPhoneVerifyForm
});
define("app/pages/settings/sms",["module","require","exports","app/boot/settings","app/data/form_scribe","app/data/settings/sms_scribe","app/ui/settings/sms_phone_create_form","app/ui/settings/device_verified_form","app/ui/settings/sms_phone_verify_form","app/ui/password_dialog","app/ui/settings_controls"],function(module, require, exports) {
var settings=require("app/boot/settings"),FormScribe=require("app/data/form_scribe"),SmsScribe=require("app/data/settings/sms_scribe"),SMSPhoneCreateForm=require("app/ui/settings/sms_phone_create_form"),DeviceVerifiedForm=require("app/ui/settings/device_verified_form"),SMSPhoneVerifyForm=require("app/ui/settings/sms_phone_verify_form"),PasswordDialog=require("app/ui/password_dialog"),SettingsControls=require("app/ui/settings_controls");module.exports=function(b){settings(b),SmsScribe.attachTo(document,b),FormScribe.attachTo("#sms-phone-create-form",{eventData:{scribeContext:{component:"create_form"}},scribeFormSubmit:!0,formElements:{mobile_country_code:"#device_country_code",mobile_address:"#device_address",mobile_carrier:"#device_carrier",mobile_language:"#device_language",activate_mobile:"#start"}}),FormScribe.attachTo("#sms-phone-verified-form",{eventData:{scribeContext:{component:"verified_form"}},scribeFormSubmit:!0,formElements:{sms_info:"#sms_info",mobile_pin:"#device_pin",enable_tweet_sms:"#device_tweets_enabled",enable_dm_sms:"#device_dms_enabled",enable_follow_sms:"#device_followed_enabled",enable_mention_sms:"#device_mentions_enabled",mention_sms_from_follows:"#device_mentions_preference_follows",mention_sms_from_all:"#device_mentions_preference_all",enable_retweet_sms:"#device_rts_enabled",retweet_sms_from_follows:"#device_rts_preference_follows",retweet_sms_from_all:"#device_rts_preference_all",enable_fav_sms:"#device_favs_enabled",fav_sms_from_follows:"#device_favs_preference_follows",fav_sms_from_all:"#device_favs_preference_all",enable_sms_sleep:"#user_scheduled_sleeping",sms_sleep_start:"#user_scheduled_sleep_start_hour",sms_sleep_end:"#user_scheduled_sleep_end_hour",save:"#settings_save"}}),FormScribe.attachTo("#password_dialog",{eventData:{scribeContext:{component:"password_dialog"}},formElements:{password:"#auth_password",save:"#save_password",cancel:"#cancel_password_button"}}),FormScribe.attachTo("#sms-phone-delete-form",{eventData:{scribeContext:{component:"verified_form",element:"delete_mobile"}},scribeFormSubmit:!0,formElements:{delete_mobile:"#delete_device"}}),FormScribe.attachTo("#sms-phone-duplicate-destroy-form",{eventData:{scribeContext:{component:"verify_form",element:"cancel_mobile_verification"}},scribeFormSubmit:!0,formElements:{cancel_mobile_verification:"#cancel_verification"}}),FormScribe.attachTo("#sms-phone-verify-form",{eventData:{scribeContext:{component:"verify_form",element:"cancel_mobile_verification"}},scribeFormSubmit:!0,formElements:{cancel_mobile_verification:"#cancel_verification"}}),FormScribe.attachTo("#sms-phone-duplicate-form",{eventData:{scribeContext:{component:"verify_form",element:"retry_mobile_verification"}},scribeFormSubmit:!0,formElements:{retry_mobile_verification:"#retry_validation"}}),SMSPhoneCreateForm.attachTo("#sms-phone-create-form",{carrierInfo:b.carrierInfo,regionsWithHiddenCarrier:b.regionsWithHiddenCarrier,defaultCountry:b.defaultCountry}),SMSPhoneVerifyForm.attachTo("#sms-phone-verify-form",{deviceId:b.phoneDeviceId}),PasswordDialog.attachTo("#password_dialog",{eventData:{scribeContext:{component:"password_dialog"}}}),DeviceVerifiedForm.attachTo("#sms-phone-verified-form"),SettingsControls.attachTo("#sms-phone-verified-form"),DeviceVerifiedForm.attachTo("#sms-email-form"),SettingsControls.attachTo("#sms-email-form")}
});
define("app/pages/settings/web_notifications",["module","require","exports","app/boot/settings"],function(module, require, exports) {
var settings=require("app/boot/settings");module.exports=function(b){settings(b)}
});
define("app/ui/settings/widgets",["module","require","exports","core/component","core/i18n"],function(module, require, exports) {
function widgets(){this.clickDelete=function(a){a.preventDefault(),this.deleteForm=$(a.target).closest("form"),this.trigger("uiOpenConfirmDialog",{titleText:_('Delete Widget'),bodyText:_('Are you sure you want to delete this Widget? Deleting the Widget will also remove it from your website.'),cancelText:_('Close'),submitText:_('Delete'),action:"WidgetDelete"})},this.confirmDelete=function(){this.deleteForm.submit()},this.after("initialize",function(){this.$deleteBtn=$(".btn-widgets-delete"),this.on(this.$deleteBtn,"click",this.clickDelete),this.on("uiWidgetDeleteConfirm",this.confirmDelete)})}var defineComponent=require("core/component"),_=require("core/i18n");module.exports=defineComponent(widgets)
});
define("app/pages/settings/widgets",["module","require","exports","app/ui/settings/widgets","app/boot/app"],function(module, require, exports) {
var widgets=require("app/ui/settings/widgets"),boot=require("app/boot/app");module.exports=function(a){boot(a),widgets.attachTo("body")}
});
define("app/ui/settings/widgets_configurator",["module","require","exports","core/component","app/utils/querystring","core/i18n","core/utils","app/data/with_data"],function(module, require, exports) {
function widgetConfigurator(){this.changingValues={},this.defaultAttrs({queryFieldseta:"#query_fieldset .controls-inner a",queryFieldset:"#query_fieldset",screenName:"#screen_name",widgetType:"#widget_type",widgetForm:"#widget-form",linkColor:"#link_color",dropdown:"#query_fieldset .dropdown-menu.typeahead",preview:"#preview",height:"#height",query:"#query",listSelect:"#list_id",listSelectOption:"#list_id option",customSelect:"#custom_timeline_id",customSelectOption:"#custom_timeline_id option",code:"#code",formFields:"#widget-form input, #widget-form select"}),this.listenForPreviewableChanges=function(){function c(b){a.changingValues[b.name]!=d(b)&&a.generatePreview(),a.changingValues[b.name]=d(b)}function d(a){return a.type=="checkbox"?!!a.checked:a.value}var a=this,b=utils.throttle(function(a){a&&c(a.target)},1e3);$(this.attr.formFields).each(function(b,c){a.changingValues[c.name]=d(c)}),this.on(this.attr.formFields,"focus blur change",b)},this.isUnpreviewable=function(){return this.widgetType=="list"&&this.$listSelect.is(":disabled")||this.widgetType=="list"&&this.$listSelectOption.is(":selected:disabled")||this.widgetType=="custom"&&this.$customSelect.is(":disabled")||this.widgetType=="custom"&&this.$customSelectOption.is(":selected:disabled")},this.generatePreview=function(){if(!this.$preview.length)return;if(this.isUnpreviewable())return;using("//platform.twitter.com/widgets.js",function(){var a={};this.$widgetForm.serializeArray().forEach(function(b){a[b.name]=b.value}),this.get({url:this.$preview.attr("data-url"),data:a,success:function(a){var b=this,c=this.$preview.height();this.$preview.empty();if(a.height<350||a.height>c)a.height=c;twttr.widgets.createTimelinePreview(a,this.$preview[0],function(a){var c,d=+a;if(!isNaN(d)){switch(d){case 400:c=_('Was unable to generate a widget preview with this configuration. Some of the settings may be in an invalid or unexpected format.');break;case 403:c=_('You don\'t have permission to create a widget with this configuration. The user may be protected or suspended.');break;case 404:c=_('The user for your widget does not exist. Try configuring for a different username.');break;case 503:c=_('Sorry, the widget preview generator is current unavailable. You may continue to configure your widget.');break;default:c=_('Sorry, there was an unexpected error generating the widget preview. You may continue to configure your widget.')}b.trigger("uiShowError",{message:c})}})}.bind(this)})}.bind(this))},this.fixTypeahead=function(){this.on("click keydown keypress",{queryFieldseta:this.preventDefaultTypeahead}),this.on("uiTypeaheadItemSelected",this.updateTypeaheadValue)},this.preventDefaultTypeahead=function(a){(a.type=="click"||a.which==13)&&a.preventDefault()},this.updateTypeaheadValue=function(a,b){this.$query.val(b.query),this.$dropdown.hide()},this.attachCodeSelector=function(){this.on(this.attr.code,"click focus",this.selectCode)},this.selectCode=function(){setTimeout(this.$code.select.bind(this.$code),20)},this.setFocus=function(){this.params.focus_textarea?this.$code.focus()&&window.scrollTo(0,this.$document.height()):this.$listSelect.length?this.$listSelect.focus():this.$query.length?this.$query.focus():this.$screenName.length?this.$screenName.focus():this.$customSelect.length&&this.$customSelect.focus()},this.invalidateForm=function(a,b){return window.scrollTo(0,0),a.focus(),this.trigger("uiShowError",{message:_('Please provide: {{name}}.',{name:b})})},this.attachFormValidation=function(){var a=["screen name"];this.on(this.attr.widgetForm,"submit",function(b){b.preventDefault();if(this.$query.is(":focus"))return;if(this.widgetType=="list"&&(this.$listSelect.is(":disabled")||this.$listSelectOption.is(":selected:disabled")))return this.invalidateForm(this.$listSelect,_('list'));if(this.widgetType=="custom"&&(this.$customSelect.is(":disabled")||this.$customSelectOption.is(":selected:disabled")))return this.invalidateForm(this.$listSelect,_('Custom Timeline'));for(var c=a.length;c--;){var d=this["$"+a[c].replace(/\s(\w)/,function(a,b){return b.toUpperCase()})];if(d.length&&!d.val().length)return this.invalidateForm(d,a[c])}this.$widgetForm[0].submit()})},this.after("initialize",function(){this.params=queryString.decode(window.location.search.replace(/^\?/,"")),this.widgetType=$(this.attr.widgetType).attr("value"),this.$widgetForm=$(this.attr.widgetForm),this.$screenName=$(this.attr.screenName),this.$linkColor=$(this.attr.linkColor),this.$dropdown=$(this.attr.dropdown),this.$document=$(document),this.$preview=$(this.attr.preview),this.$height=$(this.attr.height),this.$query=$(this.attr.query),this.$listSelect=$(this.attr.listSelect),this.$listSelectOption=$(this.attr.listSelectOption),this.$customSelect=$(this.attr.customSelect),this.$customSelectOption=$(this.attr.customSelectOption),this.$code=$(this.attr.code),$(this.attr.queryFieldset).length&&this.fixTypeahead(),this.listenForPreviewableChanges(),this.generatePreview(),this.attachCodeSelector(),this.attachFormValidation(),this.setFocus()})}var defineComponent=require("core/component"),queryString=require("app/utils/querystring"),_=require("core/i18n"),utils=require("core/utils"),withData=require("app/data/with_data");module.exports=defineComponent(widgetConfigurator,withData)
});
define("app/pages/settings/widgets_configurator",["module","require","exports","app/ui/typeahead/typeahead_dropdown","app/ui/typeahead/typeahead_input","app/ui/settings/widgets_configurator","app/ui/color_picker","app/boot/settings"],function(module, require, exports) {
var TypeaheadDropdown=require("app/ui/typeahead/typeahead_dropdown"),TypeaheadInput=require("app/ui/typeahead/typeahead_input"),configurator=require("app/ui/settings/widgets_configurator"),ColorPicker=require("app/ui/color_picker"),settings=require("app/boot/settings");module.exports=function(a){settings(a),configurator.attachTo("body"),ColorPicker.attachTo("#link_color",{offsetTop:5}),$("#query_fieldset").length&&(TypeaheadInput.attachTo("#query_fieldset",{inputSelector:"#query"}),TypeaheadDropdown.attachTo("#query_fieldset",{datasourceRenders:[["savedSearches",["savedSearches"]],["topics",["topics"]]],inputSelector:"#query"}))}
});